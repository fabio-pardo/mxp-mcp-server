
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>MXP_Virgin API Reference</title>
    <link href="images/favicon-128-aaae2aa9.png" rel="icon" type="image/png" />
    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
  background-color: #272822;
}
.highlight .nn {
  color: #ffffff;
  background-color: #272822;
}
.highlight .nl {
  color: #ffffff;
  background-color: #272822;
}
.highlight .ni {
  color: #ffffff;
  background-color: #272822;
}
.highlight .bp {
  color: #ffffff;
  background-color: #272822;
}
.highlight .vg {
  color: #ffffff;
  background-color: #272822;
}
.highlight .vi {
  color: #ffffff;
  background-color: #272822;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
  background-color: #272822;
}
.highlight .w {
  color: #ffffff;
  background-color: #272822;
}
.highlight {
  color: #ffffff;
  background-color: #272822;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
  background-color: #272822;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen-faee5fa2.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-c427a123.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-c5541673.js"></script>
  </head>

  <body class="index" data-languages="[&quot;json&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-b66b7a61.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">json</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#mxp_virgin-api-reference" class="toc-h1 toc-link" data-title="MXP_Virgin API Reference">MXP_Virgin API Reference</a>
          </li>
          <li>
            <a href="#document-history" class="toc-h1 toc-link" data-title="Document history">Document history</a>
          </li>
          <li>
            <a href="#version-history" class="toc-h1 toc-link" data-title="Version history">Version history</a>
          </li>
          <li>
            <a href="#overview" class="toc-h1 toc-link" data-title="Overview">Overview</a>
          </li>
          <li>
            <a href="#configuration" class="toc-h1 toc-link" data-title="Configuration">Configuration</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#section-database-possible-also-database-mxp-pos-possible-also-database-pos" class="toc-h2 toc-link" data-title="Section: Database (Possible also Database MXP), POS (Possible also Database POS)">Section: Database (Possible also Database MXP), POS (Possible also Database POS)</a>
                  </li>
                  <li>
                    <a href="#section-quickcodes" class="toc-h2 toc-link" data-title="Section: QuickCodes">Section: QuickCodes</a>
                  </li>
                  <li>
                    <a href="#section-logging" class="toc-h2 toc-link" data-title="Section: Logging">Section: Logging</a>
                  </li>
                  <li>
                    <a href="#section-reports" class="toc-h2 toc-link" data-title="Section: Reports">Section: Reports</a>
                  </li>
                  <li>
                    <a href="#section-authorization" class="toc-h2 toc-link" data-title="Section: Authorization">Section: Authorization</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#logging" class="toc-h1 toc-link" data-title="Logging">Logging</a>
          </li>
          <li>
            <a href="#interface-calls-specification" class="toc-h1 toc-link" data-title="Interface calls specification">Interface calls specification</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#account-get" class="toc-h2 toc-link" data-title="account/GET">account/GET</a>
                  </li>
                  <li>
                    <a href="#charge-post" class="toc-h2 toc-link" data-title="charge/POST">charge/POST</a>
                  </li>
                  <li>
                    <a href="#chargeconfirm-post" class="toc-h2 toc-link" data-title="chargeConfirm/POST">chargeConfirm/POST</a>
                  </li>
                  <li>
                    <a href="#chargerecalc-post" class="toc-h2 toc-link" data-title="chargeRecalc/POST">chargeRecalc/POST</a>
                  </li>
                  <li>
                    <a href="#credit-post" class="toc-h2 toc-link" data-title="credit/POST">credit/POST</a>
                  </li>
                  <li>
                    <a href="#crew-get" class="toc-h2 toc-link" data-title="crew/GET">crew/GET</a>
                  </li>
                  <li>
                    <a href="#crew-post" class="toc-h2 toc-link" data-title="crew/POST">crew/POST</a>
                  </li>
                  <li>
                    <a href="#document-get" class="toc-h2 toc-link" data-title="document/GET">document/GET</a>
                  </li>
                  <li>
                    <a href="#folio-get" class="toc-h2 toc-link" data-title="folio/GET">folio/GET</a>
                  </li>
                  <li>
                    <a href="#folio-post" class="toc-h2 toc-link" data-title="folio/POST">folio/POST</a>
                  </li>
                  <li>
                    <a href="#foliovoid-post" class="toc-h2 toc-link" data-title="folioVoid/POST">folioVoid/POST</a>
                  </li>
                  <li>
                    <a href="#folioupdate-post" class="toc-h2 toc-link" data-title="folioUpdate/POST">folioUpdate/POST</a>
                  </li>
                  <li>
                    <a href="#guestpin-post" class="toc-h2 toc-link" data-title="guestPin/POST">guestPin/POST</a>
                  </li>
                  <li>
                    <a href="#icafe-get" class="toc-h2 toc-link" data-title="iCafe/GET">iCafe/GET</a>
                  </li>
                  <li>
                    <a href="#icafe-post" class="toc-h2 toc-link" data-title="iCafe/POST">iCafe/POST</a>
                  </li>
                  <li>
                    <a href="#lockcard-post" class="toc-h2 toc-link" data-title="lockCard/POST">lockCard/POST</a>
                  </li>
                  <li>
                    <a href="#personimage-post" class="toc-h2 toc-link" data-title="personImage/POST">personImage/POST</a>
                  </li>
                  <li>
                    <a href="#personimagebyid-get" class="toc-h2 toc-link" data-title="personImageById/GET">personImageById/GET</a>
                  </li>
                  <li>
                    <a href="#quickcode-get" class="toc-h2 toc-link" data-title="quickCode/GET">quickCode/GET</a>
                  </li>
                  <li>
                    <a href="#sailormanifest-get" class="toc-h2 toc-link" data-title="sailorManifest/GET">sailorManifest/GET</a>
                  </li>
                  <li>
                    <a href="#void-post" class="toc-h2 toc-link" data-title="void/POST">void/POST</a>
                  </li>
                  <li>
                    <a href="#receiptimage-get" class="toc-h2 toc-link" data-title="receiptImage/GET">receiptImage/GET</a>
                  </li>
                  <li>
                    <a href="#personinvoice-get" class="toc-h2 toc-link" data-title="personInvoice/GET">personInvoice/GET</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='mailto:api@marinexchange.com?subject=MXP_Virgin API - Issue report'>Report an issue</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='mxp_virgin-api-reference'>MXP_Virgin API Reference</h1>
<p>This document includes specification of MXP Virgin calls which are used for:</p>

<ul>
<li>account information export (MXP)</li>
<li>charging and voiding charges (POS)</li>
<li>adding credit (MXP)</li>
<li>crew export (MXP)</li>
<li>document export (MXP)</li>
<li>setting guest pin (MXP)</li>
<li>folio import and export (list of all charges and credits) (MXP)</li>
<li>iCafe import and export (MXP)</li>
<li>quick codes export (MXP)</li>
<li>guest manifest export (MXP)</li>
<li>person image import and export (MXP)</li>
</ul>
<h1 id='document-history'>Document history</h1>
<p>Documentation creation date:  <strong>2019-08-08</strong></p>

<p>Documentation last update:  <strong>2024-10-16</strong></p>

<p>Latest API version: <strong>1.48.0</strong> </p>
<h1 id='version-history'>Version history</h1>
<table><thead>
<tr>
<th>Version</th>
<th>Date</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>1.48.0</td>
<td>2024-10-16</td>
<td>Changed:<br>- Returning modifiers without linked upgrade items (#67049)</td>
</tr>
<tr>
<td>1.47.0</td>
<td>2024-09-24</td>
<td>Added:<br>- added field &quot;Receipt_Nr&quot; in response call <em>chargeConfirm/POST</em> (#66686)</td>
</tr>
<tr>
<td>1.46.1</td>
<td>2024-08-30</td>
<td>Changed:<br>- Updated <em>personInvoice/GET</em> to return details of the last booking with associated account items (#66088)</td>
</tr>
<tr>
<td>1.46.0</td>
<td>2024-08-02</td>
<td>Changed:<br>- setting check to open before recalculating and cancelling it after in <em>chargeRecalc/POST</em> (#65397)<br>- setting check and check details to location type &#39;standard&#39; for package calculation purposes (#65547)</td>
</tr>
<tr>
<td>1.45.1</td>
<td>2024-07-02</td>
<td>Changed:<br>- Changed <em>charge/POST</em> and <em>chargeRecalc/POST</em> to accept strings as valid &quot;table_nr&quot; values (#65133)</td>
</tr>
<tr>
<td>1.45.0</td>
<td>2024-03-13</td>
<td>Changed:<br>- Changed <em>iCafe/GET</em> logic to consider package category name instead of package code (#61311) <br>- Updated required date format for <em>iCafe/GET</em> date_of_birth parameter to ISO 8601 (#61311)</td>
</tr>
<tr>
<td>1.44.0</td>
<td>2024-02-29</td>
<td>Changed:<br>- removed documentation from info page (#61279)<br>- supporting alphanumeric pos interface codes (#62292)</td>
</tr>
<tr>
<td>1.43.0</td>
<td>2023-11-17</td>
<td>Added:<br>- Basic authorization implementation (#60946)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Changed:<br>- sped up Status call (#59463) <br>- Checking the payer account balance when determining if casino credit can be used (#58290) <br>- Removed personal information from <em>Crew/GET</em> (#58874) <br>- Config consistency changes (#60219)<br>- Changed to 64-bit (#60945)</td>
</tr>
<tr>
<td>1.42.2</td>
<td>2023-10-17</td>
<td>Changed:<br>- added generating of payment record when calling <em>chargeConfirm/POST</em> (#60022)</td>
</tr>
<tr>
<td>1.42.1</td>
<td>2023-06-20</td>
<td>Changed:<br>- added generating of print job when calling <em>chargeConfirm/POST</em> (#57910)</td>
</tr>
<tr>
<td>1.42.0</td>
<td>2023-03-07</td>
<td>Added:<br>- new endpoint <em>chargeRecalc/POST</em> (#52655) <br>- new endpoint <em>chargeConfirm/POST</em> (#52655)</td>
</tr>
<tr>
<td>1.41.0</td>
<td>2023-01-10</td>
<td>Changed:<br>- adjusted <em>void/POST</em> to check all accounts linked to person when determining if the request should be processed (#53512) <br>-adjusted <em>charge/POST</em> to accept casino quick codes when not listed in alphabetical order in the ini (#53657) <br>- adjusted <em>void/POST</em> to only allow voiding of checks from current period (#53512)</td>
</tr>
<tr>
<td>1.40.0</td>
<td>2022-12-21</td>
<td>Changed:<br>- adjusted <em>charge/POST</em> to not multiply tax by quantity (#53118)</td>
</tr>
<tr>
<td>1.39.0</td>
<td>2022-11-18</td>
<td>Changed:<br>- adjusted error message if no invoice is found in call <em>personInvoice/GET</em> (#51524)<br>- added boolean field <em>alcohol_challenged</em> to endpoint <em>account/GET</em> (#51937)</td>
</tr>
<tr>
<td>1.38.0</td>
<td>2022-10-04</td>
<td>Added:<br>- new endpoint <em>folioUpdate/POST</em> to call <em>folio/POST</em> and <em>folioVoid/POST</em> at the same time (#50682) <br>- new parameter <em>comment</em> to <em>folio/POST</em> and <em>credit/POST</em> (#50934)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Changed:<br>- adjusted <em>charge/POST</em> to check account balance instead of unused non-refundable credit (#52285)</td>
</tr>
<tr>
<td>1.37.0</td>
<td>2022-07-27</td>
<td>Changed:<br>- adjusted <em>charge/POST</em> to reject casino charge when account has unused non-refundable credit (#48912)</td>
</tr>
<tr>
<td>1.36.2</td>
<td>2022-04-07</td>
<td>Changed:<br>- adjusted <em>personInvoice/GET</em> to be compatible with more rtm file variations (#48464)</td>
</tr>
<tr>
<td>1.36.1</td>
<td>2022-03-31</td>
<td>Changed:<br>- adjusted <em>credit/POST</em> endpoint to allow charges to accounts with no booking for company accounts (#46332) <br>- adjusted <em>folio/POST</em> endpoint to allow charges to accounts with no booking for company accounts (#46332) <br>- adjusted code for <em>print</em> to default to true in <em>folio/POST</em>(#46332) <br>- renamed endpoint <em>crewInvoice/GET</em> to <em>personInvoice/GET</em> and added support for guest invoice generation (#46290)</td>
</tr>
<tr>
<td>1.36.0</td>
<td>2022-03-09</td>
<td>Changed:<br>- adjusted <em>credit/POST</em> endpoint to accept <em>account_id</em> parameter as an alternative to <em>charge_id</em> (#46332) <br>- adjusted <em>folio/POST</em> endpoint to accept <em>account_id</em> parameter as an alternative to <em>charge_id</em>(#46332)<br>- adjusted code for <em>print</em> to default to false in <em>folio/POST</em></td>
</tr>
<tr>
<td>1.35.0</td>
<td>2021-01-26</td>
<td>Added:<br>- new endpoint <em>crewInvoice/GET</em> for generating invoices</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Changed:<br>- adjusted <em>charge/POST</em> endpoint to allow missing modifier properties and reject those with qty = 0</td>
</tr>
<tr>
<td>1.34.0</td>
<td>2021-12-22</td>
<td>Changed:<br>- adjusted <em>charge/POST</em> endpoint to work with modifiers that are not bound to an upgrade item (#46613)</td>
</tr>
<tr>
<td>1.33.0</td>
<td>2021-11-18</td>
<td>Changed:<br>- adjusted <em>charge/POST</em> endpoint to allow upsell modifiers (#41179)<br>- adjusted <em>charge/POST</em> and <em>void/POST</em> to create a payment record (#44691)</td>
</tr>
<tr>
<td>1.32.0</td>
<td>2021-09-01</td>
<td>Changed:<br>- adjusted <em>charge/POST</em> endpoint to take into account discount, tax and service_charge when verifying if credit limit is exceeded (#44084)<br>- adjusted <em>charge/POST</em> endpoint to take into account open_balance from MXP when verifying if credit limit is exceeded (#44244)</td>
</tr>
<tr>
<td>1.31.0</td>
<td>2021-06-24</td>
<td>Added:<br>- new endpoint <em>receiptImage/GET</em> for returning bill images (#42127)</td>
</tr>
<tr>
<td>1.30.0</td>
<td>2021-06-07</td>
<td>Changed:<br>- added <em>comment</em> field to <em>charge/POST</em> - check items level (#41126)<br>- added <em>comment</em> field to <em>charge/POST</em> - check level (#41648)<br>- modified <em>icafe/POST</em> to allow 0.00 amount (#42320)<br>- added &#39;MXP Virgin API&#39; to be autopopulated for <em>charge/POST</em> and <em>void/POST</em> (#42265)<br>- modified <em>guestPin/POST</em> to accept PIN change regardless if person is checked-in on current booking (#42071)</td>
</tr>
<tr>
<td>1.29.0</td>
<td>2021-04-05</td>
<td>Changed:<br>- added a call <em>lockCard/POST</em> (#39601)<br>- added validation for dependent max charge in folio/POST and removed Person Property Access link (#41441)<br>- disabled crew/POST endpoint. Crew insert is to be done solely via Kafka (#41702)</td>
</tr>
<tr>
<td>1.28.0</td>
<td>2021-03-12</td>
<td>Changed:<br>- adjusted code for <em>no_print</em> to default to false in <em>charge/POST</em>(#41188)<br>- added populating account field from existing record in <em>folioVoid/POST</em> (#41370)</td>
</tr>
<tr>
<td>1.27.0</td>
<td>2021-02-03</td>
<td>Changed:<br>- adjusted logic to locate correct package code (#40874)<br>- re-mapping field pin to PERSON_ID in <em>iCafe/GET</em> and <em>iCafe/POST</em>(#40850)<br>- removed person property access link in <em>folio/GET</em> to only return items linked directly to charge_id (EXTERNAL_ACCOUNT_ID) (#40998)</td>
</tr>
<tr>
<td>1.26.0</td>
<td>2021-01-22</td>
<td>Changed:<br>- re-mapping <em>paid_by_dependent_charge_id</em> to external record id in <em>folio/GET</em> call (#40818) <br>- <em>folio/POST</em> removed quick code number from the comment field, <em>folioVoid/POST</em> description stays the same as the original record and void_reason text is inserted into comment field (#40641)<br>- added Semaphore in Log to prevent error 500 (#40702)<br>- <em>folio/GET</em> added created field, <em>credit/POST</em> added description field, comment field is not populated with the quick code number (#38400)</td>
</tr>
<tr>
<td>1.25.0</td>
<td>2020-10-15</td>
<td>Changed:<br>- re-mapping Charge_ID to differend field in the following calls: <em>account/GET</em>, <em>crew/GET</em>, <em>folio/GET</em>, <em>iCafe/GET</em>, <em>charge/POST</em>, <em>credit/POST</em>, <em>folio/POST</em>. (#39469)</td>
</tr>
<tr>
<td>1.24.0</td>
<td>2020-09-22</td>
<td>Changed:<br>-<em>charge/POST</em>- improved error handling. (#39304)</td>
</tr>
<tr>
<td>1.23.0</td>
<td>2020-08-24</td>
<td>Changed:<br>-stored procedure modified, because no new accounts were opened for crew after sign on again.(#38890)<br>-<em>guestPin/POST</em> server error issue resolved.(#39204)</td>
</tr>
<tr>
<td>1.22.0</td>
<td>2020-08-04</td>
<td>Added:<br>- new endpoint <em>personImageById/GET</em> for returning person image and <em>document/GET</em> for returning document image (#38639)</td>
</tr>
<tr>
<td>1.21.0</td>
<td>2020-07-27</td>
<td>Changed:<br>- <em>folio/GET</em> quick_code and is_refundable logic change (#38949)</td>
</tr>
<tr>
<td>1.20.0</td>
<td>2020-07-22</td>
<td>Changed:<br>- <em>iCafe/GET</em> removed last_name as input parameter for guests (#38809)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Added:<br>- <em>crew/POST</em> added manifest_type field desription to documentation</td>
</tr>
<tr>
<td>1.19.0</td>
<td>2020-07-03</td>
<td>Changed:<br>- <em>guestPin/POST</em> improved database connection handling</td>
</tr>
<tr>
<td>1.18.0</td>
<td>2020-06-05</td>
<td>Added:<br>- new endpoint <em>sailorManifest/GET</em> (#37659)<br></td>
</tr>
<tr>
<td></td>
<td></td>
<td>Changed:<br>- <em>folio/POST</em> error messages updated, no functional changes (#38501)<br>- <em>void/POST</em> check for account status and updated error response description (#38542)</td>
</tr>
<tr>
<td>1.17.0</td>
<td>2020-05-20</td>
<td>Added:<br>- <em>folio/GET</em> added field <em>paid_by_dependent_charge_id</em> (#36679)<br>- <em>folio/GET</em> added field <em>receipt_nr</em> (#38047)<br>- <em>folio/POST</em> added field <em>receipt_nr</em> in response (#38047)</td>
</tr>
<tr>
<td>1.16.3</td>
<td>2020-04-07</td>
<td>Changed:<br>- <em>guestPin/POST</em> - additional guest PIN validation. (MXPVIR-59)<br>- <em>iCafe/GET</em> - updated query to filter only active cruises (#38006)</td>
</tr>
<tr>
<td>1.16.2</td>
<td>2020-03-11</td>
<td>Changed:<br>- <em>crew/POST</em> - position name length increased from 20 characters to 40. (MXPVIR-55)</td>
</tr>
<tr>
<td>1.16.1</td>
<td>2020-03-11</td>
<td>Changed:<br>- <em>crew/POST</em> - crew passport check box &#39;Is primary&#39; can only be checked for 1 passport record. (#37588)</td>
</tr>
<tr>
<td>1.16.0</td>
<td>2020-03-04</td>
<td>Changed:<br>- <em>charge/POST</em> - the credit limit is now enforced (MXPVIR-46)<br>- <em>crew/POST</em> - Crew can be disabled by setting <em>mxp_user</em> or <em>is_checked_in</em> to false (VVA-38)<br>- <em>crew/POST</em> - We return error when we can not map countries and added additional logging, but record is still updated, no logical changes. (MXPVIR-43)</td>
</tr>
<tr>
<td>1.15.2</td>
<td>2020-02-26</td>
<td>Changed:<br>- <em>account/GET</em> performance enhancement<br>- logging finetuning when posting binary data</td>
</tr>
<tr>
<td>1.15.1</td>
<td>2020-02-25</td>
<td>Added:<br>- <em>crew/POST</em> - added field <em>manifest_type</em><br></td>
</tr>
<tr>
<td></td>
<td></td>
<td>Changed:<br>- documentation updated for field types <em>check_id</em>, <em>account_nr</em>, <em>quick_code</em><br>- <em>iCafe/POST</em> - additional account checking (MXPVIR-24)</td>
</tr>
<tr>
<td>1.15.0</td>
<td>2020-02-05</td>
<td>Added:<br>- <em>guestPin/POST</em> - new endpoint for posting Guests&#39; data (only PIN at the moment)</td>
</tr>
<tr>
<td>1.14.3</td>
<td>2020-02-03</td>
<td>Changed:<br>- <em>personImage/POST</em> - image validation for format (only JPG) and size (between 150x175 and 400x400 px)<br>- <em>charge/POST</em> enhanced validation</td>
</tr>
<tr>
<td>1.14.2</td>
<td>2020-01-28</td>
<td>Changed:<br>- <em>folio/GET</em> enhanced data checking</td>
</tr>
<tr>
<td>1.14.1</td>
<td>2020-01-23</td>
<td>Changed:<br>- <em>crew/POST</em> enhanced validation of <em>country_of_birth</em>, <em>country_of_nationality</em>, <em>country_of_residence</em><br>- PrintJob <em>check_format</em> updated for Receipts printing</td>
</tr>
<tr>
<td>1.14.0</td>
<td>2020-01-22</td>
<td>Added:<br>- <em>void/POST</em> returns the receipt number of void charge and print jobs are created for voids (VVA-31)<br>- <em>folio/POST</em>, <em>folio/GET</em> added field <em>external_reference</em><br></td>
</tr>
<tr>
<td></td>
<td></td>
<td>Changed:<br>- Tax and Gratuity sum calculation improvement (35316, VVA-19)</td>
</tr>
<tr>
<td>1.13.2.</td>
<td>2020-01-21</td>
<td>Changed:<br>- Modifiers validation updated (VVA-29)</td>
</tr>
<tr>
<td>1.13.1</td>
<td>2020-01-20</td>
<td>Changed:<br>- <em>testPersonImage/GET</em> - temporary endpoint for checking images, improved over previous one</td>
</tr>
<tr>
<td>1.13.0</td>
<td>2020-01-20</td>
<td>Added:<br>- <em>crew/POST</em> accepts and <em>crew/GET</em> returns embarkation_city_code and debarkation_city_code. (#36829)</td>
</tr>
<tr>
<td>1.12.6</td>
<td>2020-01-15</td>
<td>Changed:<br>- <em>crew/POST</em> data validation improvement in stored procedure</td>
</tr>
<tr>
<td>1.12.5</td>
<td>2020-01-14</td>
<td>Changed:<br>- corrected request example and description in <em>quickCode/GET</em><br>- internal code for testing uploading of images</td>
</tr>
<tr>
<td>1.12.4</td>
<td>2020-01-10</td>
<td>Changed:<br>- <em>crew/POST</em> on insert use the value from <em>PIN</em> to populate <em>PERSON_PIN_CODE</em>, <em>PERSON_ORG_UNIT_CODE</em> (#36568)</td>
</tr>
<tr>
<td>1.12.3</td>
<td>2020-01-09</td>
<td>Changed:<br>- <em>charge/POST</em> improved error handling  (#35315)<br>- <em>charge/POST</em> PLU_Type check for Item and Gratuity (I, G)</td>
</tr>
<tr>
<td>1.12.2</td>
<td>2020-01-09</td>
<td>Changed:<br>- <em>crew/POST</em> - validation handling for <em>Person_Type_Id</em></td>
</tr>
<tr>
<td>1.12.1</td>
<td>2020-01-08</td>
<td>Added:<br>- <em>folio/GET</em> checks for <em>rec_deleted</em></td>
</tr>
<tr>
<td>1.12.0</td>
<td>2020-01-06</td>
<td>Changed:<br>- <em>charge/POST</em> improved error handling  (#35315)<br>- <em>crew/GET</em> return all current and future Crew (VVA-23)<br>- <em>charge/POST</em> checking for Sales tax group, Modifier (VVA-17)</td>
</tr>
<tr>
<td>1.11.0</td>
<td>2019-12-20</td>
<td>Added:<br>- <em>charge/POST</em> accepts <em>account_nr</em> as parameter (#35315)</td>
</tr>
<tr>
<td>1.10.0</td>
<td>2019-12-05</td>
<td>Added:<br>- <em>person_primary_email</em> attribute to <em>crew/GET</em> and <em>crew/POST</em> (#35216)</td>
</tr>
<tr>
<td>1.9.0</td>
<td>2019-11-29</td>
<td>Added:<br>- <em>department</em> attribute added to <em>folio/GET</em> (#32738)<br>- <em>credit/POST</em> accepts <em>quick_code</em> as parameter (#34994) <br>- added <em>/quickCode</em> endpoint <br>- added <em>/folioVoid</em> endpoint (#34923) <br>- endpoint <em>folio/POST</em> returns &quot;item_id&quot; (#34923)<br>- endpoint <em>/iCafe/GET</em> and <em>/iCafe/POST</em> accepts combination of PIN and last name as parameters for crew (#33392)<br></td>
</tr>
<tr>
<td></td>
<td></td>
<td>Changed:<br> - <em>print jobs</em> taken from the system and machine configuration (#29564)<br></td>
</tr>
<tr>
<td></td>
<td>2019-11-05</td>
<td>Changed:<br>- <em>personImage/POST</em> image specification</td>
</tr>
<tr>
<td>1.8.3</td>
<td>2019-10-23</td>
<td>Changed:<br>- <em>quick_code</em> and <em>is_refundable</em> attributes added to <em>folio/GET</em></td>
</tr>
<tr>
<td>1.8.2</td>
<td>2019-10-21</td>
<td>Changed:<br>- <em>item_description</em> parameter to <em>description</em> in <em>folio/GET</em> call<br>- <em>no_print</em> parameter was added to <em>charge/POST</em></td>
</tr>
<tr>
<td>1.8.1</td>
<td>2019-10-16</td>
<td>Changed:<br>- <em>crew/POST</em> if <em>mxp_user</em> and <em>is_checked_in</em> then login to the MXP application is allowed</td>
</tr>
<tr>
<td>1.8.0</td>
<td>2019-10-11</td>
<td>Added:<br>- <em>folio/GET</em> added fields in output: <em>transaction_type</em> and <em>voided_item_id</em> (#32738)</td>
</tr>
<tr>
<td>1.7.8</td>
<td>2019-10-07</td>
<td>Changed:<br>- <em>charge/POST</em> <em>qty</em> and <em>folio/POST</em> <em>quantity</em> parameter type changed to float.</td>
</tr>
<tr>
<td>1.7.7</td>
<td>2019-10-03</td>
<td>Changed:<br>- <em>crew/POST</em> error code added for invalid <em>position_name</em> value<br>- <em>crew</em> array description edited</td>
</tr>
<tr>
<td>1.7.6</td>
<td>2019-10-01</td>
<td>Changed:<br>- <em>crew/POST</em> parameter <em>id</em> removed, return response includes &quot;links&quot; array with PIN/person_id link and mxp_username (if created). crew/GET does not return &quot;id&quot; anymore</td>
</tr>
<tr>
<td>1.7.5</td>
<td>2019-09-27</td>
<td>Changed:<br>- <em>crew/POST</em> now creates person in users (if mxp_user)<br>- <em>crew/GET</em> input parameter <em>PIN</em> added<br>- <em>folio/POST</em> added<br>- Error response codes for all calls edited. Structure stays the same<br>- <em>personImage/POST</em> added<br>- parameters PIN, mxp_user, position_name, passport_type, passport_number, passport_first_name, passport_last_name, passport_issued_by, passport_issued_country, passport_issued_city, passport_issued_date, passport_expiration_date, passport_is_primary added to <em>crew/POST</em><br>- parameters person_id, PIN, mxp_user, username, position_name, department_name, passport_type, passport_number, passport_first_name, passport_last_name, passport_issued_by, passport_issued_country, passport_issued_city, passport_issued_date, passport_expiration_date, passport_is_primary added to <em>crew/GET</em> response</td>
</tr>
<tr>
<td>1.7.4</td>
<td>2019-09-20</td>
<td>Changed:<br>- Error responses in all api calls edited<br>- iCafe/GET and iCafe/POST edited</td>
</tr>
<tr>
<td>1.7.3</td>
<td>2019-09-13</td>
<td>Added:<br>- <em>crew/GET</em>; Changed: crew/POST uses <em>id</em> instead of <em>vxp_id</em>, expanded error details; <em>account/GET</em> returns <em>id</em> instead of <em>vxp_id</em>; Charge/POST uses <em>operator_nr</em> instead of <em>operator_id</em><br></td>
</tr>
<tr>
<td></td>
<td></td>
<td>Changed:<br>- Package/POST and Quick_codes/GET calls were replaced by iCafe/GET and iCafe/POST</td>
</tr>
<tr>
<td>1.6.0</td>
<td>2019-09-06</td>
<td>Added:<br>- <em>/package</em> and <em>/quickCode</em> endpoints<br></td>
</tr>
<tr>
<td></td>
<td></td>
<td>Changed:<br>- Docs typos<br>- <em>account</em> and <em>folio</em> return <em>charge_id</em> as number instead of string; <em>account</em> returns an object instead an array as root element</td>
</tr>
<tr>
<td>1.5.0</td>
<td>2019-08-30</td>
<td>Added:<br>- <em>/credit</em> endpoint; attribute names uniform across calls; Documentation reworked</td>
</tr>
<tr>
<td>1.4.0</td>
<td>2019-08-23</td>
<td>Changed:<br>- <em>account/GET</em> returns <em>vxp_id</em>, uniform parameter names</td>
</tr>
<tr>
<td>1.3.0</td>
<td>2019-08-22</td>
<td>Changed:<br>- Renamed endpoints: <em>folio</em> to <em>account</em>, <em>folioLookup</em> to <em>folio</em>;<br>- endpoint <em>charge</em> parameters;<br>- <em>crew</em> import reworked</td>
</tr>
<tr>
<td>1.2.1</td>
<td>2019-08-16</td>
<td>Added:<br>- <em>folio/GET</em> output <em>Charge_Id</em> and <em>Vxp_Id</em></td>
</tr>
<tr>
<td>1.2.0</td>
<td>2019-08-14</td>
<td>Added:<br>- <em>documentation</em>,<br>- <em>Folio Lookup</em></td>
</tr>
<tr>
<td>1.1.0</td>
<td>2019-08-09</td>
<td>Added:<br>- <em>crew/POST</em> for crew import, <em>invoice</em> to list all charges<br></td>
</tr>
<tr>
<td></td>
<td></td>
<td>Changed:<br>- <em>charge</em> by <em>Charge_ID</em></td>
</tr>
<tr>
<td>1.0.0</td>
<td>2019-07-20</td>
<td>Initial release</td>
</tr>
</tbody></table>
<h1 id='overview'>Overview</h1>
<p>API calls described in this documentation:</p>

<table><thead>
<tr>
<th>Function</th>
<th>Description</th>
<th>Parameters</th>
<th>Method</th>
</tr>
</thead><tbody>
<tr>
<td>account</td>
<td>Account info</td>
<td>charge_id, account_nr, id</td>
<td>GET</td>
</tr>
<tr>
<td>charge</td>
<td>Charging</td>
<td>JSON body</td>
<td>POST</td>
</tr>
<tr>
<td>chargeConfirm</td>
<td>Confirming recalculated charge</td>
<td>JSON body</td>
<td>POST</td>
</tr>
<tr>
<td>chargeRecalc</td>
<td>Charging and recalculating charge</td>
<td>JSON body</td>
<td>POST</td>
</tr>
<tr>
<td>credit</td>
<td>Credit posting for Casino</td>
<td>JSON body</td>
<td>POST</td>
</tr>
<tr>
<td>crew</td>
<td>Export of crew data</td>
<td>PIN</td>
<td>GET</td>
</tr>
<tr>
<td>document</td>
<td>Returns document image</td>
<td>id</td>
<td>GET</td>
</tr>
<tr>
<td>folio</td>
<td>Returns all the account charges</td>
<td>charge_id, date_from, date_to</td>
<td>GET</td>
</tr>
<tr>
<td>folio</td>
<td>Import of folio data</td>
<td>JSON body</td>
<td>POST</td>
</tr>
<tr>
<td>folioVoid</td>
<td>Void folio charges</td>
<td>item_id, description</td>
<td>POST</td>
</tr>
<tr>
<td>folioUpdate</td>
<td>Import and void folio charges</td>
<td>JSON body</td>
<td>POST</td>
</tr>
<tr>
<td>guestPin</td>
<td>Set Guest data (Pin)</td>
<td>guest_id, PIN</td>
<td>POST</td>
</tr>
<tr>
<td>iCafe</td>
<td>Returns a internet package for person</td>
<td>room_nr, last_name, date_of_birth</td>
<td>GET</td>
</tr>
<tr>
<td>iCafe</td>
<td>Posts an internet package</td>
<td>JSON body</td>
<td>POST</td>
</tr>
<tr>
<td>lockCard</td>
<td>Locks crew member id card</td>
<td>JSON body</td>
<td>POST</td>
</tr>
<tr>
<td>personImage</td>
<td>Posts image to person account</td>
<td>image/jpg, id</td>
<td>POST</td>
</tr>
<tr>
<td>personImageById</td>
<td>Returns person image</td>
<td>id</td>
<td>GET</td>
</tr>
<tr>
<td>personInvoice</td>
<td>Returns invoice PDF</td>
<td>charge_id</td>
<td>GET</td>
</tr>
<tr>
<td>quickCode</td>
<td>Get all quick codes for current ship</td>
<td>/</td>
<td>GET</td>
</tr>
<tr>
<td>sailorManifest</td>
<td>Returns manifest data for guests</td>
<td>installation_code, voyage_embark_date, voyage_debark_date</td>
<td>GET</td>
</tr>
<tr>
<td>void</td>
<td>Void a charge</td>
<td>JSON body</td>
<td>POST</td>
</tr>
<tr>
<td>receiptImage</td>
<td>Returns bill image</td>
<td>check_number, bu_id</td>
<td>GET</td>
</tr>
</tbody></table>
<h1 id='configuration'>Configuration</h1>
<p>The configuration file is named <em>MXP_Virgin.ini</em>.
If MXP_Virgin API does not have write permission on the folder it is located in, password will stay unencrypted and log files will not be created.</p>
<div class="highlight"><pre class="highlight ini tab-ini"><code><span class="nn">[Database]</span>
<span class="py">Provider</span><span class="p">=</span><span class="s">SQLOLEDB.1</span>
<span class="py">Host</span><span class="p">=</span><span class="s">local</span><span class="se">\i</span><span class="s">nstance</span>
<span class="py">Instance</span><span class="p">=</span><span class="s">XMP</span>
<span class="py">Database</span><span class="p">=</span><span class="s">MarineXProcurement</span>
<span class="py">Username</span><span class="p">=</span><span class="s">MXPAPIuser</span>
<span class="py">Password</span><span class="p">=</span>
<span class="err">Password</span> <span class="py">encrypted</span><span class="p">=</span><span class="s">false</span>

<span class="nn">[POS]</span>
<span class="py">Provider</span><span class="p">=</span><span class="s">SQLOLEDB.1</span>
<span class="py">Host</span><span class="p">=</span><span class="s">local</span><span class="se">\i</span><span class="s">nstance</span>
<span class="py">Instance</span><span class="p">=</span><span class="s">MXP</span>
<span class="py">Database</span><span class="p">=</span><span class="s">POS</span>
<span class="py">Username</span><span class="p">=</span><span class="s">POSUser</span>
<span class="py">Password</span><span class="p">=</span>
<span class="err">Password</span> <span class="py">encrypted</span><span class="p">=</span><span class="s">false</span>

<span class="nn">[QuickCodes]</span>
<span class="py">casinoCredit</span><span class="p">=</span>

<span class="nn">[Logging]</span>
<span class="py">LogRequestsVerbose</span><span class="p">=</span><span class="s">false</span>
<span class="py">LogRequests</span><span class="p">=</span><span class="s">false</span>
<span class="py">LogResponses</span><span class="p">=</span><span class="s">false</span>

<span class="nn">[Reports]</span>
<span class="py">Directory</span><span class="p">=</span>

<span class="nn">[Authorization]</span>
<span class="py">Authorization</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">Username</span> <span class="p">=</span><span class="s">MXP-API-User</span>
<span class="py">Password</span> <span class="p">=</span><span class="s">!veryS4f3</span>
</code></pre></div><h3 id='section-database-possible-also-database-mxp-pos-possible-also-database-pos'>Section: Database (Possible also Database MXP), POS (Possible also Database POS)</h3>
<p>Database connection settings</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>Provider</td>
<td>database provider (e.g.<em>SQLOLEDB.1</em>, <em>MSOLEDBSQL</em>). If not specified, default SQLOLEDB.1 is used.</td>
</tr>
<tr>
<td>Host</td>
<td>database server name (e.g. <em>devship.mxp-extra.net</em>) or database server name and instance name (e.g. <em>devship.mxp-extra.net\MXP</em>)</td>
</tr>
<tr>
<td>Instance</td>
<td>database instance (in case instance is not specified as part of &quot;Host&quot; parameter</td>
</tr>
<tr>
<td>Database</td>
<td>database name (e.g. MarineXProcurement)</td>
</tr>
<tr>
<td>Username</td>
<td>database user name (e.g. MXPAPIuser)</td>
</tr>
<tr>
<td>Password</td>
<td>database user password; if this is a plane password then parameter &quot;Password encrypted&quot; must be set to false</td>
</tr>
<tr>
<td>Password encrypted</td>
<td>indicator if password is encrypted; if password is not encrypted, it gets automatically encrypted on first API call and this indicator is then set to true.</td>
</tr>
</tbody></table>
<h3 id='section-quickcodes'>Section: QuickCodes</h3>
<p>Quick code settings for Folio/POST endpoint. Only internet quick codes are available </p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>casinoCredit=</td>
<td>charge type casino</td>
</tr>
</tbody></table>
<h3 id='section-logging'>Section: Logging</h3>
<p>Logging settings. Logging is off by default</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>VerboseRequestLogging (Possible also LogRequestsVerbose)</td>
<td>Extensive logging of all incoming and outgoing traffic. Note: Verbose logging may cause large log files and should only be used while debugging<br> true/false; Default value: false<br>Introduced in 1.9.3</td>
</tr>
<tr>
<td>LogRequests</td>
<td>Log requests for all calls<br> true/false; Default value: false. If set to true, LogResponses will also be set to true</td>
</tr>
<tr>
<td>LogResponses</td>
<td>Log responses for all calls<br> true/false; Default value: false</td>
</tr>
</tbody></table>
<h3 id='section-reports'>Section: Reports</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>Directory</td>
<td>output folder where invoices are stored</td>
</tr>
</tbody></table>
<h3 id='section-authorization'>Section: Authorization</h3>
<p>API has the option to require authorization for all endpoints. It uses the basic authorization standard, meaning the authorization parameters are given in the call header - Authorization= Basic {Base64 encoded username:password}.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>Authorization</td>
<td>If set to true all API calls will need to include the provided Username and Password in the header of the API calls. Authorization is turned off by default.</td>
</tr>
<tr>
<td>Username</td>
<td>Authorization username</td>
</tr>
<tr>
<td>Password</td>
<td>Authorization password</td>
</tr>
</tbody></table>
<h1 id='logging'>Logging</h1>
<p>The API logs output actions and errors in <strong>Logs</strong> folder, located in the same directory where service application is physically located. Log files are created on daily bases with the same name as corresponding application interface with extension log.</p>

<p>Example: MXP_Virgin.log</p>

<p>Directory structure (year\month\day) used for log files is:  &lt;home&gt; \ Logs \ YYYY \ MM \ DD.</p>

<p>Example: \ Logs \ 2020 \ 01 \ 31</p>
<h1 id='interface-calls-specification'>Interface calls specification</h1><h2 id='account-get'>account/GET</h2>
<p>Get the account details.</p>
<h3 id='request'>Request</h3>
<blockquote>
<p>Request example:</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>GET https://localhost/MXP_Virgin.exe/account?charge_id=10000004
</code></pre></div>
<p>HTTPS method type: <strong>GET</strong></p>

<p><code>GET https://localhost/MXP_Virgin.exe/account?charge_id=&lt;charge_id&gt;</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>integer (*)</td>
<td>Unique (ACCOUNT_EXTERNAL_ID)</td>
</tr>
<tr>
<td>age_limit_distilled_alcoholic</td>
<td>-</td>
<td>field is autopopulated from POS service</td>
</tr>
<tr>
<td>age_limit_undistilled_alcoholic</td>
<td>-</td>
<td>field is autopopulated from POS service</td>
</tr>
<tr>
<td>age_limit_tobacco</td>
<td>-</td>
<td>field is autopopulated from POS service</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='successful-response'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"account_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000002</span><span class="p">,</span><span class="w">
    </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000004</span><span class="p">,</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1A390730-6E29-4F16-8D16-A8A9C17ACE53"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"account_type"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nl">"account_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John, Doe"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"date_of_birth"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1988-01-22"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"room_nr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"103"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"account_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"is_blocked"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"credit_limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span><span class="w">
    </span><span class="nl">"total_credit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"total_discounted_debit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">6783.93</span><span class="p">,</span><span class="w">
    </span><span class="nl">"credit_no_exceptions"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"unused_non_refundable_credit"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"debits_without_exceptions"</span><span class="p">:</span><span class="w"> </span><span class="mf">6783.93</span><span class="p">,</span><span class="w">
    </span><span class="nl">"balance"</span><span class="p">:</span><span class="w"> </span><span class="mf">6783.93</span><span class="p">,</span><span class="w">
    </span><span class="nl">"total_debit_exceptions"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"packages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"package_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iPhone"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"package_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"package_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-07-19"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"package_delivery_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-09-02"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"package_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iCafe"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"package_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"package_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-07-19"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"package_delivery_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-09-01"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"alcohol_challenged"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"legal_distilled_alcoholic"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"legal_undistilled_alcoholic"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"legal_tobacco"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>account_nr</td>
<td>integer</td>
<td>MXP&#39;s internal ID</td>
</tr>
<tr>
<td>charge_id</td>
<td>bigint</td>
<td>Unique (ACCOUNT_EXTERNAL_ID)</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>Person&#39;s GUID, unique</td>
</tr>
<tr>
<td>account_type</td>
<td>integer</td>
<td>1 = Guest; 2 = Crew</td>
</tr>
<tr>
<td>account_name</td>
<td>string</td>
<td>Account holder&#39;s name</td>
</tr>
<tr>
<td>date_of_birth</td>
<td>string</td>
<td>ISO 8601 date</td>
</tr>
<tr>
<td>room_nr</td>
<td>string</td>
<td>Room number</td>
</tr>
<tr>
<td>account_status</td>
<td>string</td>
<td>&#39;A&#39; = Active, &#39;P&#39; = Pending, &#39;C&#39; = Closed, &#39;X&#39; = Voided</td>
</tr>
<tr>
<td>is_blocked</td>
<td>boolean</td>
<td>If true, charges are not allowed</td>
</tr>
<tr>
<td>credit_limit</td>
<td>number</td>
<td>Float</td>
</tr>
<tr>
<td>total_credit_amount</td>
<td>number</td>
<td>Float; sum of all credits</td>
</tr>
<tr>
<td>total_discounted_debit_amount</td>
<td>number</td>
<td>Float; sum of all debits including discounts</td>
</tr>
<tr>
<td>credit_no_exceptions</td>
<td>number</td>
<td>Float; sum of all credits that do not have exceptions</td>
</tr>
<tr>
<td>unused_non_refundable_credit</td>
<td>number</td>
<td>Float; sum of all unused credits that are not refundable</td>
</tr>
<tr>
<td>debits_without_exceptions</td>
<td>number</td>
<td>Float; sum of all debits that are not exeptions (&#39;alcohol&#39; my be an exception)</td>
</tr>
<tr>
<td>balance</td>
<td>number</td>
<td>Float; current balance with all the rules taken into account</td>
</tr>
<tr>
<td>total_debit_exceptions</td>
<td>number</td>
<td>Float; sum of all debits that are exceptions</td>
</tr>
<tr>
<td>packages</td>
<td>array</td>
<td>Array of packages assigned to the account</td>
</tr>
<tr>
<td>package_code</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>package_description</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>package_date</td>
<td>string</td>
<td>ISO 8601 date</td>
</tr>
<tr>
<td>package_delivery_date</td>
<td>string</td>
<td>ISO 8601 date</td>
</tr>
<tr>
<td>alcohol_challenged</td>
<td>boolean</td>
<td>true = allowed; false = not allowed</td>
</tr>
<tr>
<td>legal_distilled_alcoholic</td>
<td>boolean</td>
<td>true = allowed; false = not allowed</td>
</tr>
<tr>
<td>legal_undistilled_alcoholic</td>
<td>boolean</td>
<td>true = allowed; false = not allowed</td>
</tr>
<tr>
<td>legal_tobacco</td>
<td>boolean</td>
<td>true = allowed; false = not allowed</td>
</tr>
</tbody></table>
<h3 id='error-response'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {charge_id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {charge_id}</td>
<td>Required parameter <em>charge_id</em> missing</td>
</tr>
<tr>
<td>GENERAL_DATA_HANDLING_ERROR</td>
<td>Error in call AccountDataRequestHandler2 for Account/GET. Reason: &#39;ErrorMessage&#39;</td>
<td>General error with detailed reason provided</td>
</tr>
</tbody></table>
<h2 id='charge-post'>charge/POST</h2>
<p>Posting a charge to an account identified by <em>charge_id</em> or <em>account_nr</em>.</p>

<p><em>Account_nr</em> is only used to post a charge on the company and system accounts!</p>

<p>All charges done via charge/POST endpoint are being made to the POS database. Origin field is automatically populated with &#39;MXP Virgin API&#39;.</p>

<p>When verifying if charge is allowed open balance is retrieved from MXP database. If no data matches provided charge_id/account_nr in MXP database, charge is still applied but warning message is added to the MXP_Virgin.log file.</p>

<!-- "no_print" parameter set to true, sets a flag in Checks table with value 1 -->
<h3 id='request-2'>Request</h3>
<blockquote>
<p>Charge_id request example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000004</span><span class="p">,</span><span class="w">
    </span><span class="nl">"account_nr"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"operator_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">100208063</span><span class="p">,</span><span class="w">
    </span><span class="nl">"machine_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1003000000100000000</span><span class="p">,</span><span class="w">
    </span><span class="nl">"table_nr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"no_print"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7:30am  7:45am"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sequence"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"plu_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">604</span><span class="p">,</span><span class="w">
            </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"unit_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">12.13</span><span class="p">,</span><span class="w">
            </span><span class="nl">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.21</span><span class="p">,</span><span class="w">
            </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
            </span><span class="nl">"service_charge"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"modifiers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                </span><span class="nl">"modifier_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1001000000100000143</span><span class="p">,</span><span class="w">
                </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="nl">"unit_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span><span class="w">
                </span><span class="nl">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.21</span><span class="p">,</span><span class="w">
                </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"service_charge"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item information"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sequence"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nl">"plu_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">605</span><span class="p">,</span><span class="w">
            </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.3</span><span class="p">,</span><span class="w">
            </span><span class="nl">"unit_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">17.92</span><span class="p">,</span><span class="w">
            </span><span class="nl">"service_charge"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.3</span><span class="p">,</span><span class="w">
            </span><span class="nl">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.12</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Account_nr request example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"account_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000003</span><span class="p">,</span><span class="w">
    </span><span class="nl">"operator_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">100208063</span><span class="p">,</span><span class="w">
    </span><span class="nl">"machine_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1003000000100000000</span><span class="p">,</span><span class="w">
    </span><span class="nl">"table_nr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"no_print"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7:30am  7:45am"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sequence"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"plu_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">604</span><span class="p">,</span><span class="w">
            </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"unit_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">12.13</span><span class="p">,</span><span class="w">
            </span><span class="nl">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.21</span><span class="p">,</span><span class="w">
            </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
            </span><span class="nl">"service_charge"</span><span class="p">:</span><span class="w"> </span><span class="mf">3.1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"modifiers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                </span><span class="nl">"modifier_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1001000000100000143</span><span class="p">,</span><span class="w">
                </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="nl">"unit_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span><span class="w">
                </span><span class="nl">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.21</span><span class="p">,</span><span class="w">
                </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"service_charge"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item information"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sequence"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nl">"plu_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">605</span><span class="p">,</span><span class="w">
            </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.3</span><span class="p">,</span><span class="w">
            </span><span class="nl">"unit_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">17.92</span><span class="p">,</span><span class="w">
            </span><span class="nl">"service_charge"</span><span class="p">:</span><span class="w"> </span><span class="mf">3.3</span><span class="p">,</span><span class="w">
            </span><span class="nl">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.12</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>HTTPS method type: <strong>POST</strong></p>

<p><code>POST: https://localhost/MXP_Virgin.exe/charge</code></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>bigint (*)</td>
<td>Unique (ACCOUNT_EXTERNAL_ID)</td>
</tr>
<tr>
<td>account_nr</td>
<td>bigint (*)</td>
<td>Account number</td>
</tr>
<tr>
<td>operator_nr</td>
<td>integer (*)</td>
<td>Operator number</td>
</tr>
<tr>
<td>machine_id</td>
<td>bigint (*)</td>
<td></td>
</tr>
<tr>
<td>table_nr</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>no_print</td>
<td>boolean</td>
<td>Default value is false</td>
</tr>
<tr>
<td>comment</td>
<td>string</td>
<td>Used to insert expected delivery time on check level</td>
</tr>
<tr>
<td>items</td>
<td>array (*)</td>
<td>Array of items to charge</td>
</tr>
<tr>
<td>sequence</td>
<td>integer</td>
<td>Sequence number, &gt; 0</td>
</tr>
<tr>
<td>plu_nr</td>
<td>integer (*)</td>
<td>ID of the item</td>
</tr>
<tr>
<td>qty</td>
<td>number (*)</td>
<td>Float. Quantity; &gt; 0</td>
</tr>
<tr>
<td>unit_price</td>
<td>number</td>
<td>Float. Price</td>
</tr>
<tr>
<td>tax</td>
<td>number</td>
<td>Float. Tax amount</td>
</tr>
<tr>
<td>service_charge</td>
<td>number</td>
<td>Float. Service charge amount</td>
</tr>
<tr>
<td>discount</td>
<td>number</td>
<td>Float. Discount</td>
</tr>
<tr>
<td>modifiers</td>
<td>array</td>
<td>Array of modifiers</td>
</tr>
<tr>
<td>comment</td>
<td>string</td>
<td>Used to display item information on check item level</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.
Either <strong>Charge_id</strong> or <strong>Account_nr</strong> is mandatory.</p>
<h3 id='successful-response-2'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"receipt_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">208</span><span class="p">,</span><span class="w">
        </span><span class="nl">"check_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1002000000100000230</span><span class="p">,</span><span class="w">
        </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>&quot;OK&quot;</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>details</td>
<td>object</td>
<td>Charge details</td>
</tr>
<tr>
<td>receipt_nr</td>
<td>bigint</td>
<td>Consecutive receipt number</td>
</tr>
<tr>
<td>check_id</td>
<td>bigint</td>
<td></td>
</tr>
<tr>
<td>items</td>
<td>integer</td>
<td>Number of items charged</td>
</tr>
</tbody></table>
<h3 id='error-response-2'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {qty}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-2'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td></td>
<td>Charge was made successfully</td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {charge_id}</td>
<td>charge_id was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {account_nr}</td>
<td>account_nr was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {operator_nr}</td>
<td>operator_nr was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {plu_nr}</td>
<td>plu_nr was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {qty}</td>
<td>qty was not provided</td>
</tr>
<tr>
<td></td>
<td>Invalid JSON request</td>
<td>Request is not in valid JSON form</td>
</tr>
<tr>
<td></td>
<td>Too many parameters received. Use only one parameter(charge_id or account_nr)</td>
<td>invalid required parameters</td>
</tr>
<tr>
<td></td>
<td>Empty parameters received(use charge_id or account_nr)</td>
<td>invalid required parameters</td>
</tr>
<tr>
<td></td>
<td>No parameter received(use charge_id or account_nr)</td>
<td>invalid required parameters</td>
</tr>
<tr>
<td></td>
<td>Parameter with no value received</td>
<td>invalid required parameters</td>
</tr>
<tr>
<td>INVALID_PLU_NUMBER</td>
<td>Plu Item number {302102} not found</td>
<td>plu_nr used does not exist</td>
</tr>
<tr>
<td>INVALID_PLU_SALES_TAX_GROUP</td>
<td>Plu Item number {302102} has no Sales tax group set.</td>
<td>Sales tax group not set for the item</td>
</tr>
<tr>
<td>INVALID_PLU_MODIFIER</td>
<td>Plu Item number {302102] has no Modifier set</td>
<td>Modifier must be set to the item</td>
</tr>
<tr>
<td>INVALID_PLU_GRATUITY</td>
<td>Plu Item number {100000002} has no Gratuity defined but was sent with {service_charge}.</td>
<td>The item was sent</td>
</tr>
<tr>
<td>POS_ACCOUNT_STATUS_ERROR</td>
<td>The status of the Account_Nr = {10000003} does not allow charging.</td>
<td>Provided account does not allow charging.</td>
</tr>
<tr>
<td>POS_ACCOUNT_BLOCKED</td>
<td>The Account_Nr = {10000003} is blocked.</td>
<td>Provided account is blocked and cannot be charged</td>
</tr>
<tr>
<td>POS_ACCOUNT_CREDIT_LIMIT_EXCEEDED</td>
<td>The total of charge amount {81.00} and open balance {86.13} would exceed the Account_Nr = {10000003} credit limit.</td>
<td>Sum of posted items and current open balance exceed credit limit</td>
</tr>
<tr>
<td>open-check-no-account</td>
<td>No account provided</td>
<td>invalid charge_id provided</td>
</tr>
<tr>
<td>open-check-no-operator</td>
<td>No operator provided</td>
<td>invalid operator_nr provided</td>
</tr>
<tr>
<td>open-check-no-location</td>
<td>No location provided</td>
<td>invalid machine_id provided</td>
</tr>
<tr>
<td>GENERAL_SQL_ERROR</td>
<td>Error in procedure AddCharging. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td>GENERAL_POST_ERROR</td>
<td>Error in call handleCharge. Reason: &#39;+e.Message</td>
<td></td>
</tr>
</tbody></table>
<h2 id='chargeconfirm-post'>chargeConfirm/POST</h2>
<p>Posting a charge to an account identified by <em>charge_id</em> or <em>account_nr</em>.</p>

<p>All charges done via chargeRecalc/POST endpoint are being made to the POS database. Origin field is automatically populated with &#39;MXP Virgin API&#39;.</p>
<h3 id='request-3'>Request</h3>
<blockquote>
<p>Request example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"check_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1003000000100000000</span><span class="p">,</span><span class="w">
    </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is a comment"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"check_detail_id"</span><span class="p">:</span><span class="mi">1003000000100000000</span><span class="p">,</span><span class="w">
            </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item information"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>HTTPS method type: <strong>POST</strong></p>

<p><code>POST: https://localhost/MXP_Virgin.exe/chargeConfirm</code></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>check_id</td>
<td>bigint (*)</td>
<td>ID of check to be updated</td>
</tr>
<tr>
<td>items</td>
<td>array</td>
<td>Array of items to add additional comments to</td>
</tr>
<tr>
<td>check_detail_id</td>
<td>bigint</td>
<td>ID of check detail to be updated</td>
</tr>
<tr>
<td>comment</td>
<td>string</td>
<td>Used to display item information</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='successful-response-3'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"receipt_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">1077003</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>&quot;OK&quot;</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>receipt_nr</td>
<td>number</td>
<td>Large integer</td>
</tr>
</tbody></table>
<h3 id='error-response-3'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {check_id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-3'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td></td>
<td>Charge was confirmed successfully</td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {check_id}</td>
<td>check_id was not provided</td>
</tr>
<tr>
<td></td>
<td>Provided check_id is not valid for this endpoint</td>
<td>The provided check is not in a state meant for use with this endpoint</td>
</tr>
<tr>
<td></td>
<td>Invalid JSON request</td>
<td>Request is not in valid JSON form</td>
</tr>
<tr>
<td>GENERAL_SQL_ERROR</td>
<td>Error in procedure postChargeConfirm. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td>GENERAL_POST_ERROR</td>
<td>Error in call ChargeConfirm. Reason: &#39;+e.Message</td>
<td></td>
</tr>
</tbody></table>
<h2 id='chargerecalc-post'>chargeRecalc/POST</h2>
<p>Confirming a charge identified by <em>check_id</em></p>
<h3 id='request-4'>Request</h3>
<blockquote>
<p>Request example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000004</span><span class="p">,</span><span class="w">
    </span><span class="nl">"account_nr"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"operator_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">100208063</span><span class="p">,</span><span class="w">
    </span><span class="nl">"machine_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1003000000100000000</span><span class="p">,</span><span class="w">
    </span><span class="nl">"table_nr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"no_print"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"check_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1003000000100000000</span><span class="p">,</span><span class="w">
    </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sequence"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"plu_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">604</span><span class="p">,</span><span class="w">
            </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"check_detail_id"</span><span class="p">:</span><span class="mi">1003000000100000000</span><span class="p">,</span><span class="w">
            </span><span class="nl">"modifiers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                </span><span class="nl">"modifier_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1001000000100000143</span><span class="p">,</span><span class="w">
                </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item information"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sequence"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nl">"plu_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">605</span><span class="p">,</span><span class="w">
            </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.3</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Account_nr request example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"account_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000003</span><span class="p">,</span><span class="w">
    </span><span class="nl">"operator_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">100208063</span><span class="p">,</span><span class="w">
    </span><span class="nl">"machine_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1003000000100000000</span><span class="p">,</span><span class="w">
    </span><span class="nl">"table_nr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"no_print"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"check_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1003000000100000000</span><span class="w"> 
    </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sequence"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"plu_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">604</span><span class="p">,</span><span class="w">
            </span><span class="nl">"check_detail_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1003000000100000000</span><span class="p">,</span><span class="w">
            </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
            </span><span class="nl">"modifiers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                </span><span class="nl">"modifier_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1001000000100000143</span><span class="p">,</span><span class="w">
                </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item information"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"sequence"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nl">"plu_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">605</span><span class="p">,</span><span class="w">
            </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.3</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>HTTPS method type: <strong>POST</strong></p>

<p><code>POST: https://localhost/MXP_Virgin.exe/chargeRecalc</code></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>bigint (*)</td>
<td>Unique (ACCOUNT_EXTERNAL_ID)</td>
</tr>
<tr>
<td>account_nr</td>
<td>bigint (*)</td>
<td>Account number</td>
</tr>
<tr>
<td>operator_nr</td>
<td>integer (*)</td>
<td>Operator number</td>
</tr>
<tr>
<td>machine_id</td>
<td>bigint (*)</td>
<td></td>
</tr>
<tr>
<td>check_id</td>
<td>bigint</td>
<td>ID of check to be updated</td>
</tr>
<tr>
<td>table_nr</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>no_print</td>
<td>boolean</td>
<td>Default value is false</td>
</tr>
<tr>
<td>items</td>
<td>array (*)</td>
<td>Array of items to charge</td>
</tr>
<tr>
<td>check_detail_id</td>
<td>bigint</td>
<td>ID of check detail to be updated</td>
</tr>
<tr>
<td>sequence</td>
<td>integer</td>
<td>Sequence number, &gt; 0</td>
</tr>
<tr>
<td>plu_nr</td>
<td>integer (*)</td>
<td>ID of the item</td>
</tr>
<tr>
<td>qty</td>
<td>number (*)</td>
<td>Float. Quantity; &gt; 0</td>
</tr>
<tr>
<td>modifiers</td>
<td>array</td>
<td>Array of modifiers</td>
</tr>
<tr>
<td>comment</td>
<td>string</td>
<td>Used to display item information on check item level</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.
Either <strong>Charge_id</strong> or <strong>Account_nr</strong> is mandatory.</p>
<h3 id='successful-response-4'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"check_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1003000000100000000</span><span class="p">,</span><span class="w">
        </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"plu_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">604</span><span class="p">,</span><span class="w">
                </span><span class="nl">"service_charge"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
                </span><span class="nl">"unit_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">51</span><span class="p">,</span><span class="w">
                </span><span class="nl">"check_detail_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1003000000100000000</span><span class="p">,</span><span class="w">
                </span><span class="nl">"modifiers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"service_charge"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"unit_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.5</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"modifier_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1001000000100000143</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"packages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"package_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1001000000100000143</span><span class="w">
                        </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">4.2</span><span class="w">
                        </span><span class="nl">"description"</span><span class="p">:</span><span class="s2">"Package description"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"plu_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">605</span><span class="p">,</span><span class="w">
                </span><span class="nl">"service_charge"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.3</span><span class="p">,</span><span class="w">
                </span><span class="nl">"unit_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"check_detail_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1002000000101685383</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"plu_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">105999999</span><span class="p">,</span><span class="w">
                </span><span class="nl">"service_charge"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"qty"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"unit_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
                </span><span class="nl">"check_detail_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1002000000101685394</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"check_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">221.3</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>&quot;OK&quot;</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>details</td>
<td>object</td>
<td>Charge details</td>
</tr>
<tr>
<td>check_id</td>
<td>bigint</td>
<td>ID of created/updated check</td>
</tr>
<tr>
<td>items</td>
<td>array</td>
<td>Array of items</td>
</tr>
<tr>
<td>check_detail_id</td>
<td>bigint</td>
<td>ID of created/updated item</td>
</tr>
<tr>
<td>plu_nr</td>
<td>integer</td>
<td>ID of the item</td>
</tr>
<tr>
<td>qty</td>
<td>number</td>
<td>Float. Quantity; &gt; 0</td>
</tr>
<tr>
<td>unit_price</td>
<td>number</td>
<td>Float. Price</td>
</tr>
<tr>
<td>tax</td>
<td>number</td>
<td>Float. Tax amount</td>
</tr>
<tr>
<td>service_charge</td>
<td>number</td>
<td>Float. Service charge amount</td>
</tr>
<tr>
<td>discount</td>
<td>number</td>
<td>Float. Discount</td>
</tr>
<tr>
<td>modifiers</td>
<td>array</td>
<td>Array of modifiers</td>
</tr>
<tr>
<td>package_id</td>
<td>bigint</td>
<td>ID of the applied package</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>Description of the package</td>
</tr>
</tbody></table>
<h3 id='error-response-4'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {qty}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-4'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td></td>
<td>Charge was made successfully</td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {charge_id}</td>
<td>charge_id was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {account_nr}</td>
<td>account_nr was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {operator_nr}</td>
<td>operator_nr was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {plu_nr}</td>
<td>plu_nr was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {qty}</td>
<td>qty was not provided</td>
</tr>
<tr>
<td></td>
<td>Invalid JSON request</td>
<td>Request is not in valid JSON form</td>
</tr>
<tr>
<td></td>
<td>Too many parameters received. Use only one parameter(charge_id or account_nr)</td>
<td>invalid required parameters</td>
</tr>
<tr>
<td></td>
<td>Empty parameters received(use charge_id or account_nr)</td>
<td>invalid required parameters</td>
</tr>
<tr>
<td></td>
<td>No parameter received(use charge_id or account_nr)</td>
<td>invalid required parameters</td>
</tr>
<tr>
<td></td>
<td>Parameter with no value received</td>
<td>invalid required parameters</td>
</tr>
<tr>
<td>INVALID_PLU_NUMBER</td>
<td>Plu Item number {302102} not found</td>
<td>plu_nr used does not exist</td>
</tr>
<tr>
<td>INVALID_PLU_SALES_TAX_GROUP</td>
<td>Plu Item number {302102} has no Sales tax group set.</td>
<td>Sales tax group not set for the item</td>
</tr>
<tr>
<td>INVALID_PLU_MODIFIER</td>
<td>Plu Item number {302102} has no Modifier set</td>
<td>Modifier must be set to the item</td>
</tr>
<tr>
<td>INVALID_PLU_GRATUITY</td>
<td>Plu Item number {100000002} has no Gratuity defined but was sent with {service_charge}.</td>
<td>The item was sent</td>
</tr>
<tr>
<td>POS_ACCOUNT_STATUS_ERROR</td>
<td>The status of the Account_Nr = {10000003} does not allow charging.</td>
<td>Provided account does not allow charging.</td>
</tr>
<tr>
<td>POS_ACCOUNT_BLOCKED</td>
<td>The Account_Nr = {10000003} is blocked.</td>
<td>Provided account is blocked and cannot be charged</td>
</tr>
<tr>
<td>POS_ACCOUNT_CREDIT_LIMIT_EXCEEDED</td>
<td>The total of charge amount {81.00} and open balance {86.13} would exceed the Account_Nr = {10000003} credit limit.</td>
<td>Sum of posted items and current open balance exceed credit limit</td>
</tr>
<tr>
<td>open-check-no-account</td>
<td>No account provided</td>
<td>invalid charge_id provided</td>
</tr>
<tr>
<td>open-check-no-operator</td>
<td>No operator provided</td>
<td>invalid operator_nr provided</td>
</tr>
<tr>
<td>open-check-no-location</td>
<td>No location provided</td>
<td>invalid machine_id provided</td>
</tr>
<tr>
<td>recalc-check-business-unit-mismatch</td>
<td>Provided business unit does not match existing check</td>
<td>Provided business unit does not match existing check</td>
</tr>
<tr>
<td>recalc-check-account-mismatch</td>
<td>Provided account does not match existing check</td>
<td>Provided account does not match existing check</td>
</tr>
<tr>
<td>recalc-check-wrong-check</td>
<td>Sent check_detail_id does not belong to sent check_id</td>
<td>Sent item does not belong to sent check</td>
</tr>
<tr>
<td>recalc-check-plu-mismatch</td>
<td>Sent PLU_ID does not match existing PLU_ID</td>
<td>Sent PLU number does not match existing PLU number</td>
</tr>
<tr>
<td>GENERAL_SQL_ERROR</td>
<td>Error in procedure AddCharging. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td>GENERAL_POST_ERROR</td>
<td>Error in call handleCharge. Reason: &#39;+e.Message</td>
<td></td>
</tr>
</tbody></table>
<h2 id='credit-post'>credit/POST</h2>
<p>Credit posting for Casino.</p>
<h3 id='request-5'>Request</h3>
<blockquote>
<p>Request example </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000004</span><span class="p">,</span><span class="w">
    </span><span class="nl">"currency_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.5</span><span class="p">,</span><span class="w">
    </span><span class="nl">"quick_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"900"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Excursion"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"comment"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>HTTPS method type: <strong>POST</strong></p>

<p><code>POST: https://localhost/MXP_Virgin.exe/credit</code></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>bigint (+)</td>
<td>Unique (ACCOUNT_EXTERNAL_ID) *Parameter is mandatory in case parameter &quot;account_id&quot; is not specified</td>
</tr>
<tr>
<td>account_id</td>
<td>bigint (+)</td>
<td>Unique (PERSON_ACCOUNT_ID) *Parameter is mandatory in case parameter &quot;charge_id&quot; is not specified</td>
</tr>
<tr>
<td>currency_code</td>
<td>string (*)</td>
<td>3-letter currency code (example: &#39;USD&#39;, &#39;EUR&#39;)</td>
</tr>
<tr>
<td>amount</td>
<td>number (*)</td>
<td>Float</td>
</tr>
<tr>
<td>quick_code</td>
<td>string (*)</td>
<td>VARCHAR(10)</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>VARCHAR(200)</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.
At least one parameter marked with (+) is required.
In case description is empty or missing, field is populated with the quick code name.</p>
<h3 id='successful-response-5'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>&quot;OK&quot;</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td></td>
</tr>
</tbody></table>
<h3 id='error-response-5'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {charge_id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-5'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td></td>
<td></td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {charge_id}</td>
<td>charge_id was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {currency_code}</td>
<td>currency_code was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {amount}</td>
<td>amount was not provided</td>
</tr>
<tr>
<td></td>
<td>Invalid JSON request</td>
<td></td>
</tr>
<tr>
<td>GENERAL_POST_ERROR</td>
<td>Error in call CreditPost. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td>GENERAL_SQL_ERROR</td>
<td>Error in procedure CreditChargeAdd. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Error in procedure AddCharging. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td>ACCOUNT_LIMIT</td>
<td>The current account balance plus this charge exceeds the account limt of &#39;AccountLimit&#39;</td>
<td></td>
</tr>
<tr>
<td>CHARGE_NOT_ALLOWED</td>
<td>The routed account AccountID &#39;AccountId&#39; does not allow charges</td>
<td></td>
</tr>
<tr>
<td>NOT_FOUND</td>
<td>Unable to find the account record for AccountID &#39;AccountId&#39;</td>
<td></td>
</tr>
<tr>
<td>ORG_UNIT_QUICK_TYPE</td>
<td>Unsupported ORG_UNIT_QUICK_TYPE &#39;ORG_UNIT_QUICK_TYPE&#39;</td>
<td></td>
</tr>
<tr>
<td>PMS_CRUISE_NOT_FOUND</td>
<td>Current PMS cruise not found!</td>
<td></td>
</tr>
<tr>
<td>POS_CODE_NOT_FOUND</td>
<td>Unable to find an active quick code with POS code &#39;pCode&#39;</td>
<td></td>
</tr>
<tr>
<td>QUICK_CODE_NOT_FOUND</td>
<td>Unable to find an active quick code for &#39;pCode&#39;</td>
<td></td>
</tr>
<tr>
<td>STATUS_ERROR</td>
<td>The account status does not allow the addition of a record!</td>
<td></td>
</tr>
<tr>
<td>STATUS_ERROR</td>
<td>The routed account status does not allow the addition of a record!</td>
<td></td>
</tr>
</tbody></table>
<h2 id='crew-get'>crew/GET</h2>
<p>Get the data for all onboard crew.</p>
<h3 id='request-6'>Request</h3>
<blockquote>
<p>Request example:</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>GET https://localhost/MXP_Virgin.exe/crew
</code></pre></div>
<p>HTTPS method type: <strong>GET</strong></p>

<p><code>GET https://localhost/MXP_Virgin.exe/crew</code></p>
<h3 id='successful-response-6'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">22223333</span><span class="p">,</span><span class="w">
        </span><span class="nl">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jack"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"middle_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Charlie"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Johnson"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mr"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"is_person_active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"installation_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SC"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"room_nr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3223"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"arrival_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-08-09"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"departure_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2025-08-08"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"is_checked_in"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"person_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">20003115</span><span class="p">,</span><span class="w">
        </span><span class="nl">"mxp_user"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JJOHNSON"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"position_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chief Purser"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"department_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Administration"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"person_primary_email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jack.johnson@gmail.com"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"embarkation_city_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AMS"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"debarkation_city_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AES"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"manifest_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"E"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>bigint</td>
<td>Unique (ACCOUNT_EXTERNAL_ID)</td>
</tr>
<tr>
<td>first_name</td>
<td>string</td>
<td>Max length 40</td>
</tr>
<tr>
<td>middle_name</td>
<td>string</td>
<td>Max length 40</td>
</tr>
<tr>
<td>last_name</td>
<td>string</td>
<td>Max length 40</td>
</tr>
<tr>
<td>gender</td>
<td>string</td>
<td>&#39;F&#39;, &#39;M&#39; or &#39;U&#39; (undefined)</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>&#39;Mr&#39;, &#39;Mrs&#39;, ...</td>
</tr>
<tr>
<td>is_person_active</td>
<td>boolean</td>
<td></td>
</tr>
<tr>
<td>installation_code</td>
<td>string</td>
<td>Ship/installation code</td>
</tr>
<tr>
<td>room_nr</td>
<td>string</td>
<td>Max length 50</td>
</tr>
<tr>
<td>arrival_date</td>
<td>string</td>
<td>ISO 8601 date, e.g. &quot;2019-08-09&quot;</td>
</tr>
<tr>
<td>departure_date</td>
<td>string</td>
<td>ISO 8601 date, e.g. &quot;2019-08-09&quot;</td>
</tr>
<tr>
<td>is_checked_in</td>
<td>boolean</td>
<td></td>
</tr>
<tr>
<td>person_id</td>
<td>integer</td>
<td>(PERSON_ID)</td>
</tr>
<tr>
<td>mxp_user</td>
<td>boolean</td>
<td></td>
</tr>
<tr>
<td>username</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>position_name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>department_name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>person_primary_email</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>embarkation_city_code</td>
<td>string</td>
<td>3-letter city abbreviation</td>
</tr>
<tr>
<td>debarkation_city_code</td>
<td>string</td>
<td>3-letter city abbreviation</td>
</tr>
<tr>
<td>manifest_type</td>
<td>string</td>
<td>1-letter manifest type code</td>
</tr>
</tbody></table>
<h3 id='error-response-6'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {parameter}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-6'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {parameter}</td>
<td>Required parameter missing</td>
</tr>
<tr>
<td>GENERAL_DATA_HANDLING_ERROR</td>
<td>Error in call genericDataRequestHandler2 for &#39; + viewname + &#39;. Reason: &#39; + e.Message</td>
<td>General error with detailed reason provided</td>
</tr>
</tbody></table>
<h2 id='crew-post'>crew/POST</h2>
<aside class="warning">This endpoint is disabled.</aside>

<!--
Import crew members to MXP.

### Request

> Request example

```json
{
    "crew": [
        {
            "charge_id": 11112222,
            "first_name": "Betty",
            "middle_name": "Karen",
            "last_name": "White",
            "gender": "F",
            "title": "Mrs",
            "place_of_birth": "London",
            "date_of_birth": "1970-10-10",
            "country_of_birth": "GB",
            "country_of_residence": "GB",
            "country_of_nationality": "GB",
            "marital_status_id": 2,
            "is_person_active": true,
            "installation_code": "SC",
            "room_nr": "2112",
            "arrival_date": "2019-08-09",
            "departure_date": "2025-08-08",
            "is_checked_in": true,
            "PIN": 123456,
            "mxp_user": false,
            "position_name": "Chief Purser",
            "passport_type": 1,
            "passport_number": "303",
            "passport_first_name": "Betty",
            "passport_last_name": "White",
            "passport_issued_by": "Government",
            "passport_issued_country": "GB",
            "passport_issued_city": "London",
            "passport_issued_date": "2019-01-13",
            "passport_expiration_date": "2024-01-12",
            "passport_is_primary": true,
            "person_primary_email": "Betty.White@gmail.com",
            "embarkation_city_code": "AMS",
            "debarkation_city_code": "AES",
            "manifest_type": "E"
        },
        {
            "charge_id": 22223333,
            "first_name": "Jack",
            "middle_name": "Charlie",
            "last_name": "Johnson",
            "gender": "M",
            "title": "Mr",
            "place_of_birth": "London",
            "date_of_birth": "1975-03-03",
            "country_of_birth": "UK",
            "country_of_residence": "UK",
            "country_of_nationality": "Uk",
            "marital_status_id": 2,
            "is_person_active": true,
            "installation_code": "SC",
            "room_nr": "3223",
            "arrival_date": "2019-08-09",
            "departure_date": "2025-08-08",
            "is_checked_in": true,
            "PIN": 123457,
            "mxp_user": true,
            "position_name": "Chief Purser",
            "passport_type": 1,
            "passport_number": "404",
            "passport_first_name": "Jack",
            "passport_last_name": "Johnson",
            "passport_issued_by": "Government",
            "passport_issued_country": "US",
            "passport_issued_city": "New York",
            "passport_issued_date": "2018-10-01",
            "passport_expiration_date": "2023-09-30",
            "passport_is_primary": true,
            "person_primary_email": "Jack.Johnson@gmail.com",
            "embarkation_city_code": "AMS",
            "debarkation_city_code": "AES",
            "manifest_type": "E"
        }
    ]
}
```

HTTPS method type: **POST**

`POST: https://localhost/MXP_Virgin.exe/crew`

Fields                  | Data type    | Description
------------------------|--------------|------------- 
crew                    | array  (\*)  | Array of crew objects
charge_id               | bigint (\*)  | Unique (ACCOUNT_EXTERNAL_ID)
first_name              | string (\*)  | Max length 40
middle_name             | string       | Max length 40
last_name               | string (\*)  | Max length 40
gender                  | string (\*)  | 'F', 'M' or 'U' (undefined)
title                   | string       | 'Mr', 'Mrs', ...
place_of_birth          | string       |
date_of_birth           | string (\*)  | ISO 8601 date, e.g. "2019-08-09"
country_of_birth        | string       | 2-letter country code, 'UU' unknown
country_of_residence    | string       | 2-letter country code, 'UU' unknown
country_of_nationality  | string       | 2-letter country code, 'UU' unknown
marital_status_id       | integer      | 1=Single, 2=Married, 3=Married with Children, 4=Divorced, 5=Separated, 6=Unknown
is_person_active        | boolean      |                       
installation_code       | string (\*)  | Ship/installation code
room_nr                 | string (\*)  | Max length 50
arrival_date            | string (\*)  | ISO 8601 date, e.g. "2019-08-09"
departure_date          | string (\*)  | ISO 8601 date, e.g. "2019-08-09"
is_checked_in           | boolean (\*) | 
PIN                     | integer (\*) | Between 1000 and 999999 (In MXP: PERSON_EXTERNAL_ID, PERSON_PIN_CODE, PERSON_ORG_UNIT_CODE)
mxp_user                | boolean (\*) | Create also a user for the *MXP Application*.
position_name           | string (\*)  | Max length 40
passport_type           | integer (\*) | 1=Passport, 2=Seamanbook, 5=National Seamanbook
passport_number         | string (\*)  |
passport_first_name     | string (\*)  |
passport_last_name      | string (\*)  |
passport_issued_by      | string (\*)  |
passport_issued_country | string (\*)  | 2-letter country code, 'UU' unknown
passport_issued_city    | string (\*)  |
passport_issued_date    | string (\*)  | ISO 8601 date, e.g. "2019-08-09"
passport_expiration_date| string (\*)  | ISO 8601 date, e.g. "2019-08-09"
passport_is_primary     | boolean (\*) | 
person_primary_email    | string       |
embarkation_city_code   | string (\*)  | 3-letter city abbreviation
debarkation_city_code   | string (\*)  | 3-letter city abbreviation
manifest_type           | string (\*)  | 1-letter manifest type code. E.g. "E"  
 E = Employee, I = Invisible, P = Guest (in MXP-maybe not used for VV) 

Parameters marked with (\*) are required.

If a new *PIN* is posted a new record is created. If an existing "PIN" is posted then the record is updated.

If both *mxp_user* and *is_checked_in* are *true*, the MXP user is also activated. To deactivate it, one of the parameters must be false (new in v1.16.0).


### Response

> Successful response example

```json
{
    "response_code": "OK",
    "response_description": "",
    "details": {
        "inserted_count": 1,
        "updated_count": 1,
        "error_count": 0
    },
    "links": [
        {
            "PIN": 112211221122,
            "person_id": 20003114
        },
        {
            "PIN": 123456,
            "person_id": 20003115,
            "mxp_username": "JJOHNSON"
        }
    ]
}
```
 
> Error response example

```json
{
    "response_code": "ERROR_IMPORTING_CREW",
    "response_description": "Errors occured. Check the individual descriptions for details.",
    "details": {
        "inserted_count": 0,
        "updated_count": 1,
        "error_count": 1,
        "errors": [
            {
                "PIN": 123456,
                "error_code": "INVALID_INPUT_PARAMETERS",
                "error_description": "Missing or wrong parameter {charge_id}"
            }
        ]
    },
    "links": [
        {
            "PIN": 123457,
            "person_id": 20003115,
            "mxp_username": "JJOHNSON"
        }
    ]
}
```

Content-Type: **application/json**

Fields               | Data type | Description
---------------------|-----------|----------------------
response_code        | string    | "OK" or "ERROR_RESPONSE_CODE"
response_description | string    | Error description
details              | object    | Response details
inserted_count       | number    | Integer. Number of successfully inserted records
updated_count        | number    | Integer. Number of updated records
error_count          | number    | Integer. Number of unsuccessful inserts/updates
errors               | array     | Array of errors with description of each occurred error.
PIN                  | bigint    | PERSON_EXTERNAL_ID
error_code           | string    | ERROR_RESPONSE_CODE
error_description    | string    | Detailed error description
links                | array     | Array of PIN-person_id links
PIN                  | bigint    | PERSON_EXTERNAL_ID
person_id            | integer   | PERSON_ID
mxp_username         | string    | If mxp_user (in request) is set to true, mxp_username is created and returned

Notes:
- The valid records are inserted or updated even if other records contain errors.
- In case of multiple errora on one record only first encountered error is returned.

### Error response codes

Code                      | Description                    | Comment
--------------------------|--------------------------------|--------
OK                        |                                |
GENERAL_POST_ERROR        | Error in call CrewImport. Reason: '+e.Message         |
ERROR_IMPORTING_CREW      | Errors occured. Check the individual descriptions for details. |
INVALID_DATA              | Invalid data in: {"input_field_name"}. Received: {"input_field_value"} |
INVALID_INPUT_PARAMETERS  | Missing or wrong parameter {charge_id}                |
                          | Missing or wrong parameter {first_name}               |
                          | Missing or wrong parameter {last_name}                |
                          | Missing or wrong parameter {gender}                   |
                          | Missing or wrong parameter {date_of_birth}            |
                          | Missing or wrong parameter {installation_code}        |
                          | Missing or wrong parameter {arrival_date}             |
                          | Missing or wrong parameter {departure_date}           |
                          | Missing or wrong parameter {is_checked_in}            |
                          | Missing or wrong parameter {PIN}                      |
                          | Missing or wrong parameter {mxp_user}                 |
                          | Missing or wrong parameter {position_name}            |
                          | Missing or wrong parameter {passport_type}            |
                          | Missing or wrong parameter {passport_number}          |
                          | Missing or wrong parameter {passport_first_name}      |
                          | Missing or wrong parameter {passport_last_name}       |
                          | Missing or wrong parameter {passport_issued_by}       |
                          | Missing or wrong parameter {passport_issued_country}  |
                          | Missing or wrong parameter {passport_issued_city}     |
                          | Missing or wrong parameter {passport_issued_date}     |
                          | Missing or wrong parameter {passport_expiration_date} |
                          | Missing or wrong parameter {passport_is_primary}      |
                          | Missing or wrong required field : {embarkation_city_code}'; |
                          | Missing or wrong required field : {debarkation_city_code}'; |
                          | Invalid JSON request |
                          | Invalid class typecast |
MISSING_REQUIRED_FIELD    | Required field: {id}. Received: {id} |
POSITION                  | The data types varchar and ntext are incompatible in the equal to operator |
                          | Position {position} not found | Invalid position
MXP USER                  | The data types varchar and ntext are incompatible in the equal to operator |
PERSON_PASSPORT           | Application uses a value of the wrong type for the current operation |
PERSON_PASSPORT_ISSUED_COUNTRY | Country code received is not set up correctly |
PERSON_PASSPORT_IS_PRIMARY | Error when updating is_primary_passport value |

-->
<h2 id='document-get'>document/GET</h2>
<p>Get the document image.</p>
<h3 id='request-7'>Request</h3>
<blockquote>
<p>Request example:</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>GET https://localhost/MXP_Virgin.exe/document?id=82056F48-D00B-40AB-9D18-029E1FA67EFF

</code></pre></div>
<p>HTTPS method type: <strong>GET</strong></p>

<p><code>GET: https://localhost/MXP_Virgin.exe/document?id=&lt;id&gt;</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string (*)</td>
<td>Document GUID, unique</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='successful-response-7'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"document_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20000007"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"document_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ScanFinance_2020_02_23_19_31_59_615.pdf"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"document_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">".pdf"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"document_image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JVBERi0xLjUKJYCAgIAKMTEgMCBvYmoKPDwgL1R5cGUgL1BhZ2UKIC9QYXJlbnQgMyAwIFIKL1Jlc291cmNlcyA8PCAvUHJvY1NldCBbL1BERiAvSW1hZ2VCIC9JbWFnZUMgL0ltYWdlSV0vWE9iamVjdCA8PC9JMTMgMTMgMCBSPj4gPj4KL01lZGlhQm94IFswIDAgNjEyIDc5Ml0vUm90YXRlIDAvQ29udGVudHMgMTIgMCBSID4+CmVuZG9iagoxMiAwIG9iago8PCAvTGVuZ3RoIDc2Cj4+CnN0cmVhbQpxClEKcQpXCjAgMCBtCjYxMiAwIGwKNjEyIDc5MiBsCjAgNzkyIGwKaApuCnEKNjEyIDAgMCA3OTIgMCAwIGNtCi9JMTMgRG8KUQpRCmVuZHN0cmVhbQplbmRvYmoKMTMgMCBvYmoKPDwgL1R5cGUgL1hPYmplY3QKL1N1YnR5cGUgL0ltYWd....."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"date_created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-02-22T16:08:05.627"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"date_modified"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-04-21T08:41:35.560"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>document_id</td>
<td>string</td>
<td>Document identified</td>
</tr>
<tr>
<td>document_name</td>
<td>string</td>
<td>Document name</td>
</tr>
<tr>
<td>document_type</td>
<td>string</td>
<td>Document type</td>
</tr>
<tr>
<td>document_image</td>
<td>string</td>
<td>Document image, Base64 string</td>
</tr>
<tr>
<td>date_created</td>
<td>string</td>
<td>ISO 8601 date and time, e.g. &quot;2020-02-22T16:08:05.627&quot;</td>
</tr>
<tr>
<td>date_modified</td>
<td>string</td>
<td>ISO 8601 date and time, e.g. &quot;2020-04-21T08:41:35.560&quot;</td>
</tr>
</tbody></table>
<h3 id='error-response-7'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-7'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {id}</td>
<td>Required parameter missing</td>
</tr>
<tr>
<td>GENERAL_DATA_HANDLING_ERROR</td>
<td>Error in call document. Reason: &#39; + e.Message</td>
<td>General error with detailed reason provided</td>
</tr>
</tbody></table>
<h2 id='folio-get'>folio/GET</h2>
<p>Get the <em>folio</em> with all the charges to the account. Charges made through POS may take a few seconds to synchronize.</p>
<h3 id='request-8'>Request</h3>
<blockquote>
<p>Request example:</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>GET https://localhost/MXP_Virgin.exe/folio?charge_id=12345678

GET https://localhost/MXP_Virgin.exe/folio?charge_id=12345678&amp;date_from='2019-07-06'&amp;date_to='2019-07-16'
</code></pre></div>
<p>HTTPS method type: <strong>GET</strong></p>

<p><code>GET: https://localhost/MXP_Virgin.exe/folio?charge_id=&lt;charge_id&gt;</code></p>

<p><code>GET: https://localhost/MXP_Virgin.exe/folio?charge_id=&lt;charge_id&gt;&amp;date_from=&lt;YYYY-MM-DD&gt;&amp;date_to=&lt;YYYY-MM-DD&gt;</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>bigint (*)</td>
<td></td>
</tr>
<tr>
<td>date_from</td>
<td>string</td>
<td>ISO 8601 date, e.g. &quot;2019-08-01&quot;, inclusive</td>
</tr>
<tr>
<td>date_to</td>
<td>string</td>
<td>ISO 8601 date, e.g. &quot;2019-08-31&quot;, inclusive</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='successful-response-8'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">33333333</span><span class="p">,</span><span class="w">
        </span><span class="nl">"invoice_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"business_day"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-07-29"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-02-16 00:29"</span><span class="w">
        </span><span class="nl">"item_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">100000325</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POS check: 268, Tattoo Services"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"item_quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"debit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1530</span><span class="p">,</span><span class="w">
        </span><span class="nl">"credit_amount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nl">"discount_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"total_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1530</span><span class="p">,</span><span class="w">
        </span><span class="nl">"currency_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"department"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Casino"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"World Famous Tattoo"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"print"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nl">"quick_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nl">"transaction_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"void"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"voided_item_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nl">"is_refundable"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nl">"external_reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-20/12345"</span><span class="w">
        </span><span class="nl">"paid_by_dependent_charge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nl">"pos_receipt_nr"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">33333333</span><span class="p">,</span><span class="w">
        </span><span class="nl">"invoice_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"business_day"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-07-29"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-02-16 00:29"</span><span class="w">
        </span><span class="nl">"item_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">100000326</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POS check: 269, Tattoo Services"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"item_quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"debit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">-1530</span><span class="p">,</span><span class="w">
        </span><span class="nl">"credit_amount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nl">"discount_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"total_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">-1530</span><span class="p">,</span><span class="w">
        </span><span class="nl">"currency_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"department"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Casino"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"World Famous Tattoo"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"print"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nl">"quick_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Voided on POS"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"transaction_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"void"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"voided_item_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">100000325</span><span class="p">,</span><span class="w">
        </span><span class="nl">"is_refundable"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nl">"external_reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-20/12346"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"paid_by_dependent_charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">33333334</span><span class="p">,</span><span class="w">
        </span><span class="nl">"pos_receipt_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">5988</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>bigint</td>
<td>Unique (ACCOUNT_EXTERNAL_ID)</td>
</tr>
<tr>
<td>invoice_number</td>
<td>integer</td>
<td>Invoice number for the guest needed at the end of the cruise, default 1; use case: the client buys a gift for the wife and doesn&#39;t want to be shown on the invoice, a new invoice is created (invoice_number=2) and the item is assigned to it</td>
</tr>
<tr>
<td>business_day</td>
<td>string</td>
<td>ISO 8601 date, e.g. &quot;2019-08-09&quot;</td>
</tr>
<tr>
<td>created</td>
<td>string</td>
<td>Date time, e.g. &quot;2020-02-16 00:29&quot;</td>
</tr>
<tr>
<td>item_id</td>
<td>bigint</td>
<td>MXP internal item ID, unique</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>length=200</td>
</tr>
<tr>
<td>item_quantity</td>
<td>number</td>
<td>Float</td>
</tr>
<tr>
<td>debit_amount</td>
<td>number</td>
<td>Float</td>
</tr>
<tr>
<td>credit_amount</td>
<td>number</td>
<td>Float</td>
</tr>
<tr>
<td>discount_amount</td>
<td>number</td>
<td>Float</td>
</tr>
<tr>
<td>total_amount</td>
<td>number</td>
<td>Float. Negative for credits</td>
</tr>
<tr>
<td>currency_code</td>
<td>string</td>
<td>3-letter currency code (example: &#39;USD&#39;, &#39;EUR&#39;)</td>
</tr>
<tr>
<td>department</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>location</td>
<td>string</td>
<td>Location of purchase</td>
</tr>
<tr>
<td>print</td>
<td>boolean</td>
<td>If set to true item is shown on invoice</td>
</tr>
<tr>
<td>quick_code</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>transaction_type</td>
<td>string</td>
<td>Possible values: 1-debit, 2-credit, 3-settlement, void</td>
</tr>
<tr>
<td>voided_item_id</td>
<td>integer</td>
<td>if &quot;transaction_type&quot; equals &quot;void&quot;, &quot;voided_item_id&quot; value equals &quot;item_id&quot; of the voided record</td>
</tr>
<tr>
<td>is_refundable</td>
<td>boolean</td>
<td></td>
</tr>
<tr>
<td>external_reference</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>paid_by_dependent_charge_id</td>
<td>bigint</td>
<td><em>null</em> if paying for self, or paying for a dependent</td>
</tr>
<tr>
<td>receipt_nr</td>
<td>integer</td>
<td><em>null</em> if not a POS charge</td>
</tr>
</tbody></table>
<h3 id='error-response-8'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {charge_id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-8'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {charge_id}</td>
<td>Required parameter missing</td>
</tr>
<tr>
<td>GENERAL_DATA_HANDLING_ERROR</td>
<td>Error in call genericDataRequestHandler2 for &#39; + viewname + &#39;. Reason: &#39; + e.Message</td>
<td>General error with detailed reason provided</td>
</tr>
</tbody></table>
<h2 id='folio-post'>folio/POST</h2>
<p>Import of folio data.</p>
<h3 id='request-9'>Request</h3>
<blockquote>
<p>Request example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000004</span><span class="p">,</span><span class="w">
    </span><span class="nl">"currency_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3</span><span class="p">,</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.5</span><span class="p">,</span><span class="w">
    </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nl">"quick_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8000"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"print"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"external_reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-20/12346"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"comment"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>HTTPS method type: <strong>POST</strong></p>

<p><code>POST: https://localhost/MXP_Virgin.exe/folio</code></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>bigint (*)</td>
<td>Unique (ACCOUNT_EXTERNAL_ID) *Parameter is mandatory in case parameter &quot;account_id&quot; is not specified</td>
</tr>
<tr>
<td>account_id</td>
<td>bigint (*)</td>
<td>Unique (PERSON_ACCOUNT_ID) *Parameter is mandatory in case parameter &quot;charge_id&quot; is not specified</td>
</tr>
<tr>
<td>currency_code</td>
<td>string (*)</td>
<td>3-letter currency code (example: &#39;USD&#39;, &#39;EUR&#39;)</td>
</tr>
<tr>
<td>quantity</td>
<td>number (*)</td>
<td>Float</td>
</tr>
<tr>
<td>amount</td>
<td>number (*)</td>
<td>Float</td>
</tr>
<tr>
<td>discount</td>
<td>number (*)</td>
<td>Float</td>
</tr>
<tr>
<td>quick_code</td>
<td>string (*)</td>
<td></td>
</tr>
<tr>
<td>description</td>
<td>string (*)</td>
<td></td>
</tr>
<tr>
<td>print</td>
<td>boolean</td>
<td></td>
</tr>
<tr>
<td>external_reference</td>
<td>string</td>
<td>VARCHAR(50)</td>
</tr>
<tr>
<td>comment</td>
<td>string</td>
<td>VARCHAR(240)</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='successful-response-9'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
   </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nl">"item_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">90000422</span><span class="p">,</span><span class="w">
       </span><span class="nl">"receipt_nr"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>&quot;OK&quot;</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>item_id</td>
<td>bigint</td>
<td>Unique id</td>
</tr>
<tr>
<td>receipt_nr</td>
<td>integer</td>
<td>always <em>null</em> because this is not a POS charge</td>
</tr>
</tbody></table>
<h3 id='error-response-9'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {charge_id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-9'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td></td>
<td></td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {charge_id}</td>
<td>charge_id parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {currency_code}</td>
<td>currency_code parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {quantity}</td>
<td>quantity parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {amount}</td>
<td>amount parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {discount}</td>
<td>discount parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {quick_code}</td>
<td>quick_code parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {description}</td>
<td>description parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {print}</td>
<td>print parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Invalid JSON request</td>
<td></td>
</tr>
<tr>
<td>QUICK_CODE_NOT_FOUND</td>
<td>Unable to find an active quick code for quick_code</td>
<td></td>
</tr>
<tr>
<td>GENERAL_SQL_ERROR</td>
<td>Error in procedure AddCharging. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td>ACCOUNT_LIMIT</td>
<td>The current account balance plus this charge exceed the account limit of X</td>
<td>No dashes</td>
</tr>
<tr>
<td>CHARGE_NOT_ALLOWED</td>
<td>Account AccountID={X} does not allow charges.</td>
<td></td>
</tr>
<tr>
<td>ORG_UNIT_QUICK_TYPE</td>
<td>Unsupported ORG_UNIT_QUICK_TYPE &#39;ORG_UNIT_QUICK_TYPE&#39;</td>
<td></td>
</tr>
<tr>
<td>PMS_CRUISE_NOT_FOUND</td>
<td>Current PMS cruise not found!</td>
<td></td>
</tr>
<tr>
<td>STATUS_ERROR</td>
<td>The account status does not allow the addition of a record!</td>
<td>The account does not allow charging, e.g. may be Closed.</td>
</tr>
<tr>
<td>STATUS_ERROR</td>
<td>The routed account status does not allow the addition of a record!</td>
<td></td>
</tr>
</tbody></table>
<h2 id='foliovoid-post'>folioVoid/POST</h2>
<p>Voiding folio charges (only folio/POST charges and not charge/POST).</p>
<h3 id='request-10'>Request</h3>
<blockquote>
<p>Request example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="w">    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"item_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000004</span><span class="p">,</span><span class="w">
        </span><span class="nl">"void_reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Refund"</span><span class="w">   
    </span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>HTTPS method type: <strong>POST</strong></p>

<p><code>POST: https://localhost/MXP_Virgin.exe/folioVoid</code></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>item_id</td>
<td>integer(*)</td>
<td>Item_id to be voided</td>
</tr>
<tr>
<td>void_reason</td>
<td>string (*)</td>
<td>Reason for voiding, VARCHAR(240)</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='successful-response-10'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"item_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000004</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>&quot;OK&quot;</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>item_id</td>
<td>integer</td>
<td>Unique id of the Void itself; In <em>folio/Get</em> this <em>item_id</em> is the void of the item posted</td>
</tr>
</tbody></table>
<h3 id='error-response-10'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {item_id} "</span><span class="w">
    </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"item_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000005</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-10'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td></td>
<td></td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {parameter_name}</td>
<td>Missing parameter or wrong value in {parameter_name}</td>
</tr>
<tr>
<td>CHARGE_NOT_FOUND</td>
<td>Charge for {item_id} not found. Received: {item_id}</td>
<td>Charge with given item_id not found</td>
</tr>
<tr>
<td>CHARGE_ALREADY_VOIDED</td>
<td>Charge with {item_id} was already voided with {item_id}.</td>
<td>Charge with given item_id was already voided</td>
</tr>
<tr>
<td>CHARGES_NOT_ALLOWED</td>
<td>AccountID {person_account_id} does not allow charges.</td>
<td>Account does not allow charges</td>
</tr>
<tr>
<td></td>
<td>Routed AccountID {person_account_id} does not allow charges.</td>
<td>Routed account does not allow charges</td>
</tr>
<tr>
<td>ACCOUNT_NOT_FOUND</td>
<td>Account not found for {person_account_id}.</td>
<td>Account not found</td>
</tr>
<tr>
<td>ACCOUNT_STATUS_ERROR</td>
<td>The account status does not allow the addition of a record</td>
<td>Account status does not allow the addition of a record</td>
</tr>
<tr>
<td></td>
<td>The routed account status does not allow charges!</td>
<td>The routed account does not allow the addition of a record</td>
</tr>
<tr>
<td>CRUISE_NOT_FOUND</td>
<td>Current PMS cruise not set.</td>
<td>Cruise not found</td>
</tr>
</tbody></table>
<h2 id='folioupdate-post'>folioUpdate/POST</h2>
<p>Import of folio data.</p>
<h3 id='request-11'>Request</h3>
<blockquote>
<p>Request example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"folioPost"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000004</span><span class="p">,</span><span class="w">
        </span><span class="nl">"currency_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3</span><span class="p">,</span><span class="w">
        </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.5</span><span class="p">,</span><span class="w">
        </span><span class="nl">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nl">"quick_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8000"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"print"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"external_reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-20/12346"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"comment"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"folioVoid"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"item_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000004</span><span class="p">,</span><span class="w">
        </span><span class="nl">"void_reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Refund"</span><span class="w">   
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>HTTPS method type: <strong>POST</strong></p>

<p><code>POST: https://localhost/MXP_Virgin.exe/folioUpdate</code></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>bigint (*)</td>
<td>Unique (ACCOUNT_EXTERNAL_ID) *Parameter is mandatory in case parameter &quot;account_id&quot; is not specified</td>
</tr>
<tr>
<td>account_id</td>
<td>bigint (*)</td>
<td>Unique (PERSON_ACCOUNT_ID) *Parameter is mandatory in case parameter &quot;charge_id&quot; is not specified</td>
</tr>
<tr>
<td>currency_code</td>
<td>string (*)</td>
<td>3-letter currency code (example: &#39;USD&#39;, &#39;EUR&#39;)</td>
</tr>
<tr>
<td>quantity</td>
<td>number (*)</td>
<td>Float</td>
</tr>
<tr>
<td>amount</td>
<td>number (*)</td>
<td>Float</td>
</tr>
<tr>
<td>discount</td>
<td>number (*)</td>
<td>Float</td>
</tr>
<tr>
<td>quick_code</td>
<td>string (*)</td>
<td></td>
</tr>
<tr>
<td>description</td>
<td>string (*)</td>
<td></td>
</tr>
<tr>
<td>print</td>
<td>boolean</td>
<td></td>
</tr>
<tr>
<td>external_reference</td>
<td>string</td>
<td>VARCHAR(50)</td>
</tr>
<tr>
<td>comment</td>
<td>string</td>
<td>VARCHAR(240)</td>
</tr>
<tr>
<td>item_id</td>
<td>integer(*)</td>
<td>Item_id to be voided</td>
</tr>
<tr>
<td>void_reason</td>
<td>string (*)</td>
<td>Reason for voiding, VARCHAR(240)</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='successful-response-11'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
   </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"folio"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"item_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">90000422</span><span class="p">,</span><span class="w">
            </span><span class="nl">"receipt_nr"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"folioVoid"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"item_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000004</span><span class="w">
        </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>&quot;OK&quot;</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>item_id</td>
<td>bigint</td>
<td>Unique id</td>
</tr>
<tr>
<td>receipt_nr</td>
<td>integer</td>
<td>always <em>null</em> because this is not a POS charge</td>
</tr>
</tbody></table>
<h3 id='error-response-11'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {charge_id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-11'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td></td>
<td></td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {charge_id}</td>
<td>charge_id parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {currency_code}</td>
<td>currency_code parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {quantity}</td>
<td>quantity parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {amount}</td>
<td>amount parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {discount}</td>
<td>discount parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {quick_code}</td>
<td>quick_code parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {description}</td>
<td>description parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {print}</td>
<td>print parameter was not provided</td>
</tr>
<tr>
<td></td>
<td>Invalid JSON request</td>
<td></td>
</tr>
<tr>
<td>QUICK_CODE_NOT_FOUND</td>
<td>Unable to find an active quick code for quick_code</td>
<td></td>
</tr>
<tr>
<td>GENERAL_SQL_ERROR</td>
<td>Error in procedure AddCharging. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td>ACCOUNT_LIMIT</td>
<td>The current account balance plus this charge exceed the account limit of X</td>
<td>No dashes</td>
</tr>
<tr>
<td>CHARGE_NOT_ALLOWED</td>
<td>Account AccountID={X} does not allow charges.</td>
<td></td>
</tr>
<tr>
<td>ORG_UNIT_QUICK_TYPE</td>
<td>Unsupported ORG_UNIT_QUICK_TYPE &#39;ORG_UNIT_QUICK_TYPE&#39;</td>
<td></td>
</tr>
<tr>
<td>PMS_CRUISE_NOT_FOUND</td>
<td>Current PMS cruise not found!</td>
<td></td>
</tr>
<tr>
<td>STATUS_ERROR</td>
<td>The account status does not allow the addition of a record!</td>
<td>The account does not allow charging, e.g. may be Closed.</td>
</tr>
<tr>
<td>STATUS_ERROR</td>
<td>The routed account status does not allow the addition of a record!</td>
<td></td>
</tr>
<tr>
<td>CHARGE_NOT_FOUND</td>
<td>Charge for {item_id} not found. Received: {item_id}</td>
<td>Charge with given item_id not found</td>
</tr>
<tr>
<td>CHARGE_ALREADY_VOIDED</td>
<td>Charge with {item_id} was already voided with {item_id}.</td>
<td>Charge with given item_id was already voided</td>
</tr>
<tr>
<td>CHARGES_NOT_ALLOWED</td>
<td>AccountID {person_account_id} does not allow charges.</td>
<td>Account does not allow charges</td>
</tr>
<tr>
<td></td>
<td>Routed AccountID {person_account_id} does not allow charges.</td>
<td>Routed account does not allow charges</td>
</tr>
<tr>
<td>ACCOUNT_NOT_FOUND</td>
<td>Account not found for {person_account_id}.</td>
<td>Account not found</td>
</tr>
<tr>
<td>ACCOUNT_STATUS_ERROR</td>
<td>The account status does not allow the addition of a record</td>
<td>Account status does not allow the addition of a record</td>
</tr>
<tr>
<td></td>
<td>The routed account status does not allow charges!</td>
<td>The routed account does not allow the addition of a record</td>
</tr>
<tr>
<td>CRUISE_NOT_FOUND</td>
<td>Current PMS cruise not set.</td>
<td>Cruise not found</td>
</tr>
</tbody></table>
<h2 id='guestpin-post'>guestPin/POST</h2>
<p>Setting and updating Guest PINs. PIN numbers can be updated regardless if person is checked-in on current booking.</p>
<h3 id='request-12'>Request</h3>
<blockquote>
<p>Request example </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"guest_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{DA00F8BF-AF0B-4E89-8724-2E31530A7DE6}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"PIN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"012345"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>HTTPS method type: <strong>POST</strong></p>

<p><code>POST: https://localhost/MXP_Virgin.exe/guestPin</code></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>guest_id</td>
<td>string (*)</td>
<td>GUID</td>
</tr>
<tr>
<td>PIN</td>
<td>string (*)</td>
<td>4 to 6 digits string, can have a leading 0</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='successful-response-12'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>&quot;OK&quot;</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td></td>
</tr>
</tbody></table>
<h3 id='error-response-12'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {guest_id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-12'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td></td>
<td></td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {guest_id}</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Missing or wrong parameter {PIN}</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Invalid JSON request</td>
<td></td>
</tr>
<tr>
<td>GUEST_NOT_FOUND</td>
<td>No guest was found for provided GUID</td>
<td></td>
</tr>
<tr>
<td>MULTIPLE_GUESTS_FOUND</td>
<td>Multiple guests were found for provided GUID</td>
<td></td>
</tr>
<tr>
<td>INVALID_PIN</td>
<td>The PIN must have 4 to 6 digits. Received: {ABC}.</td>
<td></td>
</tr>
</tbody></table>
<h2 id='icafe-get'>iCafe/GET</h2>
<p>Get iCafe package information.</p>

<p>To get <strong>guest</strong> package information you must use combination of <em>room_nr</em> and <em>date_of_birth</em> as the input parameters.</p>

<p>To get <strong>crew</strong> package information you must use combination of <em>pin</em> and <em>last_name</em> as the input parameters.</p>
<h3 id='request-13'>Request</h3>
<blockquote>
<p>Request example:</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>GET GUEST https://localhost/MXP_VIRGIN.exe/iCafe?room_nr=115&amp;date_of_birth=1988-01-21
GET CREW  https://localhost/MXP_VIRGIN.exe/iCafe?last_name=Benjamin&amp;pin=430291293
</code></pre></div>
<p>HTTPS method type: <strong>GET</strong></p>

<p><code>https://localhost/MXP_VIRGIN.exe/iCafe?room_nr=&lt;room_nr&gt;&amp;date_of_birth=&lt;YYYY-MM-DD&gt;</code>
<code>https://localhost/MXP_VIRGIN.exe/iCafe?last_name=&lt;last_name&gt;&amp;pin=&lt;pin&gt;</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>room_nr</td>
<td>string (*)</td>
<td>Room number</td>
</tr>
<tr>
<td>date_of_birth</td>
<td>string (*)</td>
<td>DateTime. ISO 8601 date</td>
</tr>
<tr>
<td>pin</td>
<td>bigint (*)</td>
<td>PERSON_ID</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='successful-response-13'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345678</span><span class="p">,</span><span class="w">
        </span><span class="nl">"person_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">98765432</span><span class="p">,</span><span class="w">
        </span><span class="nl">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Alice"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Wonderland"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"date_of_birth"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1988-10-22"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"room_nr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234M"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"cruise_start"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nl">"cruise_end"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nl">"packages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"package_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iCafe"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"package_start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-03-22 00:00:00"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"package_end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-03-23 00:00:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"package_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iCafe"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"package_start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-03-19 00:00:00"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"package_end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-03-21 00:00:00"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>bigint</td>
<td>Unique (ACCOUNT_EXTERNAL_ID)</td>
</tr>
<tr>
<td>person_id</td>
<td>integer</td>
<td>Person identifier</td>
</tr>
<tr>
<td>first_name</td>
<td>string</td>
<td>Person first name</td>
</tr>
<tr>
<td>last_name</td>
<td>string</td>
<td>Person last name</td>
</tr>
<tr>
<td>date_of_birth</td>
<td>string</td>
<td>ISO 8601 date. Person date of birth</td>
</tr>
<tr>
<td>room_nr</td>
<td>string</td>
<td>Room number</td>
</tr>
<tr>
<td>cruise_start</td>
<td>string</td>
<td>ISO 8601 date. Cruise start date</td>
</tr>
<tr>
<td>cruise_end</td>
<td>string</td>
<td>ISO 8601 date. Cruise end date</td>
</tr>
<tr>
<td>package_code</td>
<td>string</td>
<td>Package code</td>
</tr>
<tr>
<td>package_start</td>
<td>string</td>
<td>ISO 8601 date and time. Package start date</td>
</tr>
<tr>
<td>package_end</td>
<td>string</td>
<td>ISO 8601 date and time. Package end date</td>
</tr>
</tbody></table>
<h3 id='error-response-13'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {last_name}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-13'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {parameter_name}</td>
<td>Required parameter <em>parameter_name</em> missing</td>
</tr>
<tr>
<td>GENERAL_DATA_HANDLING_ERROR</td>
<td>Error in call genericDataRequestHandler2 for &#39; + viewname + &#39;. Reason: &#39; + e.Message</td>
<td>General error with detailed reason provided</td>
</tr>
</tbody></table>
<h2 id='icafe-post'>iCafe/POST</h2>
<p>Post a iCafe package.</p>

<p>To post a package for a <strong>guest</strong> you must use combination of <em>room_nr</em>, <em>last_name</em> and <em>date_of_birth</em> as parameters.</p>

<p>To post a package for a <strong>crew</strong> you must use combination of <em>pin</em> and <em>last_name</em> as parameters.</p>
<h3 id='request-14'>Request</h3>
<blockquote>
<p>Request example for a guest</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"room_nr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"115"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mite"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"date_of_birth"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1988-01-21"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"package_start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-04-23 18:25:43"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"package_end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-04-24 18:25:43"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"quick_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"301303"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"package_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iCafe"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Request example for a crew</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"pin"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000003</span><span class="p">,</span><span class="w">
    </span><span class="nl">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grabner"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"package_start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-04-24 18:25:43"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"package_end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-04-26 18:25:43"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"quick_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"900"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"package_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iCafe"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>HTTPS method type: <strong>POST</strong></p>

<p><code>POST: https://localhost/MXP_VIRGIN.exe/iCafe</code></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>room_nr</td>
<td>string (+)</td>
<td>Room number</td>
</tr>
<tr>
<td>last_name</td>
<td>string (*)</td>
<td>Person last name</td>
</tr>
<tr>
<td>date_of_birth</td>
<td>string (+)</td>
<td>ISO 8601 date. Person date of birth</td>
</tr>
<tr>
<td>pin</td>
<td>bigint (+)</td>
<td>Pin (PERSON_ID)</td>
</tr>
<tr>
<td>package_start</td>
<td>string (*)</td>
<td>ISO 8601 date and time. Package start date</td>
</tr>
<tr>
<td>package_end</td>
<td>string (*)</td>
<td>ISO 8601 date and time. Package end date</td>
</tr>
<tr>
<td>amount</td>
<td>number (*)</td>
<td>Float</td>
</tr>
<tr>
<td>quick_code</td>
<td>string (*)</td>
<td>VARCHAR(10)</td>
</tr>
<tr>
<td>package_code</td>
<td>string (*)</td>
<td></td>
</tr>
</tbody></table>

<p>Note:</p>

<ul>
<li>Required fields are determined by a person type (guest or crew).</li>
<li>Required fields for <strong>guest</strong>: last_name, room_nr and date_of_birth.</li>
<li>Required fields for <strong>crew</strong>: last_name and pin.</li>
<li>Parameters marked with (*) are required for both person types. Parameters marked with (+) are required for guest or crew. </li>
</ul>
<h3 id='successful-response-14'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>OK</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td></td>
</tr>
</tbody></table>
<h3 id='error-response-14'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {last_name}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-14'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td></td>
<td></td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {parameter_name}</td>
<td>Required parameter <em>parameter_name</em> was not provided</td>
</tr>
<tr>
<td>PACKAGE_POST_ERROR</td>
<td>Person with last_name &#39;lastName&#39; not found.</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Person with charge_id &#39;chargeId&#39; not found.</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Package with package_code &#39;Package_Code&#39; already purchased!.</td>
<td></td>
</tr>
<tr>
<td>GENERAL_POST_ERROR</td>
<td>Error in call CreditPost. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td>GENERAL_SQL_ERROR</td>
<td>Error in procedure CreditChargeAdd. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Error in procedure AddCharging. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Error in procedure AddPackages. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td>ACCOUNT_LIMIT</td>
<td>The current account balance plus this charge exceeds the account limt of &#39;AccountLimit&#39;</td>
<td></td>
</tr>
<tr>
<td>CHARGE_NOT_ALLOWED</td>
<td>The routed account AccountID &#39;AccountId&#39; does not allow charges</td>
<td></td>
</tr>
<tr>
<td>NOT_FOUND</td>
<td>Unable to find the account record for AccountID &#39;AccountId&#39;</td>
<td></td>
</tr>
<tr>
<td>ORG_UNIT_QUICK_TYPE</td>
<td>Unsupported ORG_UNIT_QUICK_TYPE &#39;ORG_UNIT_QUICK_TYPE&#39;</td>
<td></td>
</tr>
<tr>
<td>PMS_CRUISE_NOT_FOUND</td>
<td>Current PMS cruise not found!</td>
<td></td>
</tr>
<tr>
<td>POS_CODE_NOT_FOUND</td>
<td>Unable to find an active quick code with POS code &#39;pCode&#39;</td>
<td></td>
</tr>
<tr>
<td>QUICK_CODE_NOT_FOUND</td>
<td>Unable to find an active quick code for &#39;pCode&#39;</td>
<td></td>
</tr>
<tr>
<td>STATUS_ERROR</td>
<td>The account status does not allow the addition of a record!</td>
<td></td>
</tr>
<tr>
<td>STATUS_ERROR</td>
<td>The routed account status does not allow the addition of a record!</td>
<td></td>
</tr>
</tbody></table>
<h2 id='lockcard-post'>lockCard/POST</h2>
<p>Endpoint is used to lock crew members active account and prevent further charging.</p>
<h3 id='request-15'>Request</h3>
<blockquote>
<p>Request example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234567890</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>HTTPS method type: <strong>POST</strong></p>

<p><code>POST: https://localhost/MXP_VIRGIN.exe/lockCard</code></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>bigint (*)</td>
<td>Unique (ACCOUNT_EXTERNAL_ID)</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='successful-response-15'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Card - Account blocked."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234567890</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>OK</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Card - account blocked</td>
</tr>
<tr>
<td>details</td>
<td>object</td>
<td></td>
</tr>
<tr>
<td>charge_id</td>
<td>number</td>
<td>bigint</td>
</tr>
</tbody></table>
<h3 id='error-response-15'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CANNOT_LOCK"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Account with charge_id: 1234567890 is not crew account."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"charge_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234567890</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
<tr>
<td>details</td>
<td>object</td>
<td></td>
</tr>
<tr>
<td>charge_id</td>
<td>number</td>
<td>bigint</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-15'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td>Card locked.</td>
<td>Card was successfully locked</td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {parameter_name}. Recieved: 1234567890</td>
<td>Required parameter <em>parameter_name</em> was not provided</td>
</tr>
<tr>
<td>INVALID_CHARGE_ID</td>
<td>No account record exists for charge_id: 1234567890</td>
<td>Recieved charge_id does not exist in the database</td>
</tr>
<tr>
<td>ALREADY_LOCKED</td>
<td>Account with charge_id: 1234567890 is already locked.</td>
<td>Cannot lock already locked card</td>
</tr>
<tr>
<td>CANNOT_LOCK</td>
<td>Account with charge_id: 1234567890 is not crew account.</td>
<td>Card can only be locked for active crew members</td>
</tr>
</tbody></table>

<!--

## package/POST

Add package.

### Request

> Request example 

```json
{
    "charge_id": 10000004,
    "amount": 29.90,
    "package_code": "iCafe",
    "quick_code": "301301" 
}
```

HTTPS method type: **POST**

`POST: https://localhost/MXP_Virgin.exe/package`

Fields        | Data type    | Description
--------------|--------------|-------------
charge_id     | bigint (\*)  | Guest unique identifier
amount        | number (\*)  | Float
package_code  | string (\*)  | Package code
quick_code    | string (\*)  | Quick code

Parameters marked with (\*) are required.

### Response examples

> Successful response example

```json
{
    "response_code": "OK"
}
```

> Error response example

```json
{
    "response_code": "ERROR",
    "response_description": "Package already purchased!"
}
```

Content-Type: **application/json**

Fields               | Data type | Description
---------------------|-----------|----------------------
response_code        | string    | "OK" or Error code
response_description | string    | Description if an error occurs
-->
<h2 id='personimage-post'>personImage/POST</h2>
<p>Posts image to person account.</p>
<h3 id='request-16'>Request</h3>
<p>Request sent with attached file in as multipart/form-data (image in .jpg format) must be sent. </p>

<p>The image resolution must be between <em>150x175</em> and <em>400x400</em> px (inclusive values).</p>

<p>The suggested JPEG compression factor is <em>85</em>.</p>

<blockquote>
<p>Request example</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>POST https://localhost/MXP_Virgin.exe/personImage?id=1A390730-6E29-4F16-8D16-A8A9C17ACE53
</code></pre></div>
<p>HTTPS method type: <strong>POST</strong> with multipart/form-data</p>

<p><code>POST: https://localhost/MXP_Virgin.exe/personImage?id=&lt;id&gt;</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>Unique</td>
</tr>
</tbody></table>
<h3 id='successful-response-16'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INSERTED"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>OK</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>&quot;INSERTED&quot; or &quot;UPDATED&quot;</td>
</tr>
</tbody></table>
<h3 id='error-response-16'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ADD_IMAGE_ERROR"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Person with id {1A390730-6E29-4F16-8D16-A8A9C17ACE51} not found."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>

<p>Error <strong>Error retrieving image. Please make sure the POST request is a &quot;multipart/form-data&quot;</strong> occurs when image is not added to request.</p>
<h3 id='error-response-codes-16'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td>&quot;INSERTED&quot; or &quot;UPDATED&quot;</td>
<td>Image was inserted or updated</td>
</tr>
<tr>
<td>ADD_IMAGE_ERROR</td>
<td>Person with id ?? not found</td>
<td>id provided does not exist in the database</td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter &#39;parameter&#39;</td>
<td></td>
</tr>
<tr>
<td>GENERAL_SQL_ERROR</td>
<td>Error in procedure AddPersonImage. Reason: &#39;+e.Message</td>
<td>id was not supplied or it is not in correct form.</td>
</tr>
</tbody></table>
<h2 id='personimagebyid-get'>personImageById/GET</h2>
<p>Get the person image.</p>
<h3 id='request-17'>Request</h3>
<blockquote>
<p>Request example:</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>GET https://localhost/MXP_Virgin.exe/personImageById?id=12345678

</code></pre></div>
<p>HTTPS method type: <strong>GET</strong></p>

<p><code>GET: https://localhost/MXP_Virgin.exe/personImageById?id=&lt;id&gt;</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer(*)</td>
<td>MXP internal person identified</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='successful-response-17'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"person_image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/9j/4AAQSkZJRgABAgAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAE...."</span><span class="p">,</span><span class="w">
   </span><span class="nl">"date_created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-02-22T16:08:05.627"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"date_modified"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-04-21T08:41:35.560"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>person_image</td>
<td>string</td>
<td>Person image, Base64 string</td>
</tr>
<tr>
<td>date_created</td>
<td>string</td>
<td>ISO 8601 date and time, e.g. &quot;2020-02-22T16:08:05.627&quot;</td>
</tr>
<tr>
<td>date_modified</td>
<td>string</td>
<td>ISO 8601 date and time, e.g. &quot;2020-04-21T08:41:35.560&quot;</td>
</tr>
</tbody></table>
<h3 id='error-response-17'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-17'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {id}</td>
<td>Required parameter missing</td>
</tr>
<tr>
<td>GENERAL_DATA_HANDLING_ERROR</td>
<td>Error in call personImageById. Reason: &#39; + e.Message</td>
<td>General error with detailed reason provided</td>
</tr>
</tbody></table>
<h2 id='quickcode-get'>quickCode/GET</h2>
<p>Get all quick codes for the current ship.</p>
<h3 id='request-18'>Request</h3>
<p>Request example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>GET https://localhost/MXP_Virgin.exe/quickCode
</code></pre></div>
<p>HTTPS method type: <strong>GET</strong></p>

<p><code>GET https://localhost/MXP_Virgin.exe/quickCode</code></p>

<p>No input parameters.</p>
<h3 id='response'>Response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"quick_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"900"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"quick_code_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Casino"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"quick_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9009"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"quick_code_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Casino Credit"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>quick_code</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>quick_code_name</td>
<td>string</td>
<td>Quick code name</td>
</tr>
</tbody></table>
<h2 id='sailormanifest-get'>sailorManifest/GET</h2>
<p>Returns manifest data for guests. Guest booking data is returned if at least one of the persons <em>embark_date</em> or <em>debark_date</em> fall between parameters <em>voyage_embark_date</em> and <em>voyage_debark_date</em>.</p>
<h3 id='request-19'>Request</h3>
<p>Request example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>GET https://localhost/MXP_Virgin.exe/sailorManifest?installation_code=AB&amp;voyage_embark_date=2020-05-03&amp;voyage_debark_date=2020-05-17
</code></pre></div>
<p>HTTPS method type: <strong>GET</strong></p>

<p><code>GET https://localhost/MXP_Virgin.exe/sailorManifest?installation_code=&lt;ship_code&gt;&amp;voyage_embark_date=&lt;YYYY-MM-DD&gt;&amp;voyage_debark_date=&lt;YYYY-MM-DD&gt;</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>installation_code</td>
<td>string (*)</td>
<td>Ship/installation code</td>
</tr>
<tr>
<td>voyage_embark_date</td>
<td>string (*)</td>
<td>ISO 8601 date.</td>
</tr>
<tr>
<td>voyage_debark_date</td>
<td>string (*)</td>
<td>ISO 8601 date.</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='response-2'>Response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Stan"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"vxp_res_guest_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"201EC4C6-F9D3-4B16-847E-73A5CAD68728"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"cabin_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3256D"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"reservation_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">50916</span><span class="p">,</span><span class="w">
        </span><span class="nl">"embark_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-08"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"debark_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-11"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Francine"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"vxp_res_guest_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14FCE900-545E-444C-9F38-F99702C8DEEB"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"cabin_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8258V"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"reservation_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"140580"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"embark_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-03"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"debark_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-08"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CN"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>first_name</td>
<td>string</td>
<td>guest first name</td>
</tr>
<tr>
<td>last_name</td>
<td>string</td>
<td>guest last name</td>
</tr>
<tr>
<td>vxp_res_guest_id</td>
<td>string</td>
<td>VXP reservation guest id</td>
</tr>
<tr>
<td>cabin_number</td>
<td>string</td>
<td>room number</td>
</tr>
<tr>
<td>reservation_number</td>
<td>string</td>
<td>booking reference</td>
</tr>
<tr>
<td>embark_date</td>
<td>string</td>
<td>guest arrival date</td>
</tr>
<tr>
<td>debark_date</td>
<td>string</td>
<td>guest departure date</td>
</tr>
<tr>
<td>status</td>
<td>string</td>
<td>guest booking status. Possible values: 0 - OF-Proposed, 1 - RS-Confirmed, 3 - CN-Cancelled, OT-Other</td>
</tr>
</tbody></table>
<h3 id='error-response-18'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {installation_code}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-18'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {parameter_name}</td>
<td>The <em>parameter_name</em> is missing or has an invalid value.</td>
</tr>
</tbody></table>
<h2 id='void-post'>void/POST</h2>
<p>This endpoint is used to void a charge. Charges voided with void/POST endpoint are voided from POS database. Origin field is automatically populated with &#39;MXP Virgin API&#39;.</p>
<h3 id='request-20'>Request</h3>
<blockquote>
<p>Request example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"operator_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">100208064</span><span class="p">,</span><span class="w">
    </span><span class="nl">"check_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1001000000100000015</span><span class="p">,</span><span class="w">
    </span><span class="nl">"void_reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Reason for voiding"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>HTTPS method type: <strong>POST</strong></p>

<p><code>POST https://localhost/MXP_Virgin.exe/void</code></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>operator_nr</td>
<td>bigint (*)</td>
<td>Operator number</td>
</tr>
<tr>
<td>check_id</td>
<td>bigint (*)</td>
<td>Received in the <code>charge/GET</code> response</td>
</tr>
<tr>
<td>void_reason</td>
<td>string (*)</td>
<td>Reason for voiding</td>
</tr>
</tbody></table>
<h3 id='successful-response-18'>Successful response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"check_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1002000000100000235</span><span class="p">,</span><span class="w">
        </span><span class="nl">"void_check_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1002000000100000236</span><span class="w">
        </span><span class="nl">"void_receipt_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">509</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Content-Type: <strong>application/json</strong></p>

<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>OK</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
<tr>
<td>details</td>
<td>object</td>
<td></td>
</tr>
<tr>
<td>check_id</td>
<td>bigint</td>
<td></td>
</tr>
<tr>
<td>void_check_id</td>
<td>bigint</td>
<td></td>
</tr>
<tr>
<td>void_receipt_nr</td>
<td>bigint</td>
<td>Receipt number of void charge</td>
</tr>
</tbody></table>
<h3 id='error-response-19'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"check-not-closed"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Check is not closed. Please try again."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"check_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1002000000100000235</span><span class="w">
        </span><span class="nl">"void_check_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"void_receipt_nr"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
<tr>
<td>details</td>
<td>object</td>
<td></td>
</tr>
<tr>
<td>check_id</td>
<td>bigint</td>
<td></td>
</tr>
<tr>
<td>void_check_id</td>
<td>bigint</td>
<td></td>
</tr>
<tr>
<td>void_receipt_nr</td>
<td>bigint</td>
<td></td>
</tr>
</tbody></table>
<h3 id='error-response-codes-19'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>OK</td>
<td></td>
<td></td>
</tr>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {parameter_name}</td>
<td>The <em>parameter_name</em> is missing or has an invalid value.</td>
</tr>
<tr>
<td></td>
<td>Invalid JSON request</td>
<td></td>
</tr>
<tr>
<td>check-not-closed</td>
<td>Check is not closed. Please try again.</td>
<td></td>
</tr>
<tr>
<td>check-account-blocked</td>
<td>Account is blocked.</td>
<td></td>
</tr>
<tr>
<td>check-account-not-active</td>
<td>This account has been closed, please activate the account before you void the charge.</td>
<td></td>
</tr>
<tr>
<td>check-no-void-reason</td>
<td>Void reason not specified.</td>
<td></td>
</tr>
<tr>
<td>check-no-void-operator</td>
<td>Operator not found. Please try again.</td>
<td></td>
</tr>
<tr>
<td>check-not-exists-or-deleted</td>
<td>Check does not exit or it was deleted. Please try again.</td>
<td></td>
</tr>
<tr>
<td>check-previous-period</td>
<td>Void from previous cruise is not allowed via API, please use mobile POS to void from previous cruises.</td>
<td></td>
</tr>
<tr>
<td>GENERAL_SQL_ERROR</td>
<td>Error in procedure voidCharge. Reason: &#39;+e.Message</td>
<td></td>
</tr>
<tr>
<td>GENERAL_POST_ERROR</td>
<td>Error in call handleVoid. Reason: &#39;+e.Message</td>
<td></td>
</tr>
</tbody></table>
<h2 id='receiptimage-get'>receiptImage/GET</h2>
<p>Returns bill image data.</p>
<h3 id='request-21'>Request</h3>
<blockquote>
<p>Request example:</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>GET https://localhost/MXP_VIRGIN.exe/receiptImage?check_number=58127&amp;bu_id=2

</code></pre></div>
<p>HTTPS method type: <strong>GET</strong></p>

<p><code>GET https://localhost/MXP_VIRGIN.exe/receiptImage?check_number=&lt;check_number&gt;&amp;bu_id=&lt;bu_id&gt;</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>check_number</td>
<td>number (*)</td>
<td>Bigint.</td>
</tr>
<tr>
<td>bu_id</td>
<td>number (*)</td>
<td>Integer. Bussines unit identifier</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='response-3'>Response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"check_image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/9j/4AAQSkZJRg..../"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"check_format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JPG"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"rec_created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-06-15T13:26:58.827"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"rec_changed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-06-15T13:30:06.003"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>check_image</td>
<td>string</td>
<td>Bill image. Base64 string</td>
</tr>
<tr>
<td>check_format</td>
<td>string</td>
<td>Format</td>
</tr>
<tr>
<td>rec_created</td>
<td>string</td>
<td>ISO 8601 date and time, e.g. &quot;2021-07-22T16:08:05.627&quot;</td>
</tr>
<tr>
<td>rec_changed</td>
<td>string</td>
<td>ISO 8601 date and time, e.g. &quot;2021-07-22T16:08:05.627&quot;</td>
</tr>
</tbody></table>
<h3 id='error-response-20'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {bu_id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-20'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {parameter_name}</td>
<td>The <em>parameter_name</em> is missing or has an invalid value.</td>
</tr>
<tr>
<td>GENERAL_DATA_HANDLING_ERROR</td>
<td>Error in call ReceiptImage. Reason: &#39; + e.Message</td>
<td>General error with detailed reason provided</td>
</tr>
</tbody></table>
<h2 id='personinvoice-get'>personInvoice/GET</h2>
<p>Returns invoice PDF data.</p>
<h3 id='request-22'>Request</h3>
<blockquote>
<p>Request example:</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>GET https://localhost/MXP_VIRGIN.exe/personInvoice?charge_id=20015141

</code></pre></div>
<p>HTTPS method type: <strong>GET</strong></p>

<p>`GET https://localhost/MXP_VIRGIN.exe/personInvoice?charge_id=<charge_id></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge_id</td>
<td>number (*)</td>
<td>Bigint.</td>
</tr>
</tbody></table>

<p>Parameters marked with (*) are required.</p>
<h3 id='response-4'>Response</h3>
<blockquote>
<p>Successful response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"invoice_image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9j4AAQSkZJRg..../"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>invoice_image</td>
<td>string</td>
<td>Invoice PDF encoded as base64 string</td>
</tr>
</tbody></table>
<h3 id='error-response-21'>Error response</h3>
<blockquote>
<p>Error response example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"response_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INVALID_INPUT_PARAMETERS"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing or wrong parameter {charge_id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Fields</th>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_code</td>
<td>string</td>
<td>ERROR_RESPONSE_CODE</td>
</tr>
<tr>
<td>response_description</td>
<td>string</td>
<td>Detailed error description</td>
</tr>
</tbody></table>
<h3 id='error-response-codes-21'>Error response codes</h3>
<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>INVALID_INPUT_PARAMETERS</td>
<td>Missing or wrong parameter {parameter_name}</td>
<td>The <em>parameter_name</em> is missing or has an invalid value.</td>
</tr>
<tr>
<td>GENERAL_ERROR</td>
<td>Error in call personInvoice. Reason: &#39; + e.Message</td>
<td>General error with detailed reason provided</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="json">json</a>
          </div>
      </div>
    </div>
  </body>
</html>
